import{r as T,j as e,P as Y,O as J,A as K,M as Q}from"./index-DL0DrrMB.js";import{T as Z}from"./TableHead-DhLweL-m.js";import{b as y,c as i,T as ee,a as te}from"./TableRow-nzEGKWAC.js";import{B as k}from"./Button-CYbAdjG6.js";import{P as ne,p as H}from"./PlayerMenu-BM90PNhb.js";import{T as z}from"./Header-Cawyf8IT.js";import"./Select-CoPdjEYA.js";import"./isMuiElement-DSYnSGnD.js";import"./useSlotProps-D0ubbMPy.js";import"./Grid-DZ4x4E7R.js";import"./useThemeProps-CViDHTJB.js";import"./TextField-IHEHDLYP.js";const D=T.memo(({sx:t})=>e.jsx(Z,{children:e.jsxs(y,{sx:{borderBottom:2},children:[e.jsx(i,{children:"Minimum Required for Bonus"}),e.jsx(i,{children:"How to Score"}),e.jsx(i,{sx:t,children:"Game Score"})]})}));D.displayName="Header";const E=T.memo(({topSum:t,finalTopSum:n,sx:o})=>e.jsxs(e.Fragment,{children:[e.jsxs(y,{sx:{borderTop:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Total == 63"}),e.jsx(i,{sx:o,children:t})]}),e.jsxs(y,{children:[e.jsx(i,{component:"th",scope:"row",children:"Bonus if >= 63"}),e.jsx(i,{children:"Score 35"}),e.jsx(i,{sx:o,children:t%100>=63?35:0})]}),e.jsxs(y,{sx:{borderBottom:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Upper Half Total"}),e.jsx(i,{sx:o,children:n})]})]}));E.displayName="TopScores";const R=()=>(t,n)=>(t[n]?t[n]+=1:t[n]=1,t),$=(t,n)=>{const o=t.reduce(R(),{});let s=!1;return Object.values(o).forEach(c=>{c>=n&&(s=!0)}),s},oe=t=>{const n=t.reduce(R(),{});let o=!1,s=!1;return Object.values(n).forEach(c=>{c>=3?o=!0:c>=2&&(s=!0)}),o&&s},N=(t,n)=>{const o=t.reduce(R(),{});let s=0;return[1,2,3,4,5,6].forEach(l=>{s<n&&(o[l]?s+=1:s=0)}),s>=n},se=(t,n)=>Object.entries(t.reduce(R(),{})).reduce((o,[s,c])=>c===5&&n[Number(s)-1].score>=0?!0:o,!1),re=({bottom:t,values:n,showScoreButtons:o,getScoreButton:s,top:c,sx:l,topSum:f,finalTopSum:r})=>{const a=p=>n.reduce((h,w)=>(w===p&&(h[0]+=1,h[1]+=p),h),[0,0]),d=t[5].score>0&&$(n,5),b=(p,h,w,S)=>p>=0?p:o?s(h,d?w+100:w,!0,S):null;return e.jsxs(e.Fragment,{children:[c.map(({name:p,score:h},w)=>{const S=w+1,[B,g]=a(S),C=B>=1;return e.jsxs(y,{children:[e.jsx(i,{component:"th",scope:"row",children:`${p}: ${S},${S},${S} = ${S*3}`}),e.jsx(i,{children:`Add Only ${p}`}),e.jsx(i,{sx:l,children:b(h,C,g,w)})]},p)}),e.jsx(E,{topSum:f,finalTopSum:r,sx:l})]})},v="Sum of Dice",G=T.memo(({finalTopSum:t,bottomSum:n,sx:o})=>e.jsxs(e.Fragment,{children:[e.jsxs(y,{sx:{borderTop:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Lower Half Total"}),e.jsx(i,{sx:o,children:n})]}),e.jsxs(y,{children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Upper Half Total"}),e.jsx(i,{sx:o,children:t})]}),e.jsxs(y,{sx:{borderBottom:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Grand Total"}),e.jsx(i,{sx:o,children:t+n})]})]}));G.displayName="BottomScores";const ce=t=>t.reduce((n,o)=>n+o,0),ae=(t,n)=>{switch(t){case 0:return $(n,3);case 1:return $(n,4);case 2:return oe(n);case 3:return N(n,4);case 4:return N(n,5);case 5:return $(n,5);case 6:return!0;default:return console.error("Unexpected Value"),!1}},le=({values:t,showScoreButtons:n,getScoreButton:o,top:s,bottom:c,sx:l,finalTopSum:f,bottomSum:r})=>{const a=T.useCallback((d,b,p,h)=>d>=0?d:n?p&&se(t,s)?o(!0,b+100,!1,h):o(ae(h,t),b,!1,h):null,[o,n,s,t]),m=T.useCallback(()=>{const d=c[5].score>0;return c.map((b,p)=>{const{name:h,hint:w,points:S,score:B}=b,g=S===v?ce(t):S;return e.jsxs(y,{children:[e.jsx(i,{component:"th",scope:"row",children:h}),e.jsx(i,{children:w}),e.jsx(i,{sx:l,children:a(B,g,d,p)})]},h)})},[c,a,l,t]);return e.jsxs(e.Fragment,{children:[m(),e.jsx(G,{bottomSum:r,finalTopSum:f,sx:l})]})},A={textAlign:"center"},ie=({bottom:t,bottomSum:n,finalTopSum:o,showScoreButtons:s,top:c,topSum:l,values:f,onTopScore:r,onBottomScore:a})=>{const m=T.useCallback((d,b,p,h)=>d?e.jsx(k,{color:"secondary",variant:"outlined",onClick:p?()=>r(b,h):()=>a(b,h),children:`Add ${b} Points`}):e.jsx(k,{color:"secondary",variant:"outlined",onClick:p?()=>r(0,h):()=>a(0,h),children:"0"}),[a,r]);return e.jsxs(ee,{size:"small","aria-label":"yahtzee game table",children:[e.jsx(D,{sx:A}),e.jsxs(te,{children:[e.jsx(re,{finalTopSum:o,getScoreButton:m,showScoreButtons:s,sx:A,top:c,values:f,bottom:t,topSum:l}),e.jsx(le,{finalTopSum:o,getScoreButton:m,showScoreButtons:s,sx:A,top:c,values:f,bottom:t,bottomSum:n})]})]})},M=T.memo(({bestScore:t,lastScore:n,money:o,name:s})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-container",children:[e.jsx(z,{variant:"h2",component:"h1",children:"Yahtzee"}),e.jsx(ne,{})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs(z,{variant:"h4",component:"h2",children:[s,": $",o]}),e.jsx(z,{variant:"h4",children:`Best: ${t}`}),e.jsx(z,{variant:"h4",children:`Last: ${n}`})]})]}));M.displayName="Header";const de={display:"block",margin:"auto",width:320},he=({values:t,saved:n,roll:o,handleUnsave:s,handleSave:c,handleDiceRoll:l,getButtonText:f})=>e.jsxs("div",{className:"flex-container",children:[e.jsx(z,{variant:"h4",component:"h3",children:`Roll #${o}/3`}),e.jsxs("div",{style:de,children:[n.map((r,a)=>e.jsx(k,{variant:"contained",onClick:()=>s(a),children:r},a)),t.map((r,a)=>e.jsx(k,{color:"secondary",variant:"outlined",onClick:()=>c(a),children:r},a))]}),e.jsx(k,{onClick:l,variant:"contained",disabled:o===3,children:f(o)})]}),P=()=>({roll:0,values:[0,0,0,0,0],saved:[],turn:0,showScoreButtons:!1,topScores:[-1,-1,-1,-1,-1,-1],bottomScores:[-1,-1,-1,-1,-1,-1,-1]}),F=J("yahtzeeAtom",{...P(),bestScore:0,lastScore:0}),me=Y(t=>{const{topScores:n,bottomScores:o}=t(F),{name:s}=t(H)[0];let c=0;const l=n.reduce((m,d)=>(d>=0&&(c+=1,m+=d),m),0),f=o.reduce((m,d)=>(d>=0&&(c+=1,m+=d),m),0);let r=l;l>=63&&(r+=35);const a=c>=13;return{topSum:l,bottomSum:f,finalTopSum:r,finish:a,name:s}}),ue=Y(t=>{const n=t(F),{money:o}=t(H)[0];return{...n,money:o}},(t,n,{money:o,...s})=>{n(F,s);const c=t(H),l=[...c];l[0]={...c[0],money:o},n(H,l)}),pe=()=>{const[t,n]=K(ue);return{state:t,newGame:r=>n({...P(),lastScore:r,bestScore:r>t.bestScore?r:t.bestScore,money:t.money+Math.ceil(r/10)}),diceClick:(r,a)=>n({...t,values:r,saved:a}),updateTop:r=>n({...t,topScores:r,showScoreButtons:!1,roll:0,values:[0,0,0,0,0],saved:[]}),updateBottom:r=>n({...t,bottomScores:r,showScoreButtons:!1,roll:0,values:[0,0,0,0,0],saved:[]}),updateRoll:(r,a,m,d)=>n({...t,values:r,saved:a,roll:m,showScoreButtons:!0,money:d?t.money-25:t.money})}},xe=[{name:"Aces"},{name:"Twos"},{name:"Threes"},{name:"Fours"},{name:"Fives"},{name:"Sixes"}],je=[{name:"3 of a kind",hint:v,points:v},{name:"4 of a kind",hint:v,points:v},{name:"Full House",hint:"Score 25",points:25},{name:"Sm. Straight (4)",hint:"Score 30",points:30},{name:"Lg. Straight (5)",hint:"Score 40",points:40},{name:"Yahtzee",hint:"Score 50",points:50},{name:"Chance",hint:v,points:v}],fe=T.memo(()=>{const{state:t,diceClick:n,newGame:o,updateTop:s,updateBottom:c,updateRoll:l}=pe(),{topScores:f,bottomScores:r,values:a,saved:m,roll:d,showScoreButtons:b,bestScore:p,lastScore:h,money:w}=t,{topSum:S,bottomSum:B,finalTopSum:g,finish:C,name:V}=Q(me),O=()=>{if(C){o(g+B);return}if(d>=3)return;const u=[...a],x=[...m];for(let j=0;j<u.length;j+=1)u[j]=Math.floor(Math.random()*6)+1;u.sort(),x.sort(),l(u,x,d+1,B+S===0&&d===0)},L=u=>{if(a[u]===0)return;const x=[...a],j=[...m];j.push(x.splice(u,1)[0]),j.sort(),n(x,j)},U=u=>{const x=[...a],j=[...m];x.push(j.splice(u,1)[0]),x.sort(),n(x,j)},I=T.useCallback(u=>{if(C)return"New Game";switch(u){case 0:return"First Roll";case 1:return"Second Roll";case 2:return"Last Roll";case 3:return"Score";default:return"Error"}},[C]),q=(u,x)=>{const j=[...f];j[x]=u,s(j)},W=(u,x)=>{const j=[...r];j[x]=u,c(j)},X=f.map((u,x)=>({...xe[x],score:u})),_=r.map((u,x)=>({...je[x],score:u}));return e.jsxs(e.Fragment,{children:[e.jsx(M,{bestScore:p,lastScore:h,money:w,name:V}),e.jsx("hr",{"aria-hidden":!0}),e.jsx(he,{values:a,saved:m,roll:d,handleUnsave:U,handleSave:L,handleDiceRoll:O,getButtonText:I}),e.jsx("hr",{"aria-hidden":!0}),e.jsx(z,{variant:"h4",children:`Total: ${g+B}`}),e.jsx(ie,{values:[...m,...a],bottom:_,top:X,onTopScore:q,onBottomScore:W,showScoreButtons:b,topSum:S,finalTopSum:g,bottomSum:B})]})});fe.displayName="Yahtzee";export{fe as default};
//# sourceMappingURL=index-CtEQGtoC.js.map
