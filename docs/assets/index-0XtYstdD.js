import{j as m,f as O}from"./mui-vendor-DwHfRDFJ.js";import{r as E}from"./react-vendor-BmItGCZH.js";import{t as A,a as v,d as H,G as P}from"./GameTable-DOk0YbcH.js";import{p as D,P as j}from"./PlayerMenu-DVAkSdPf.js";import{b as F,c as I,u as M,e as C}from"./index-CCegoXLu.js";var f=(e=>(e.DISCARD_CARDS="Discard Cards",e.END_TURN="End Turn",e.NEW_GAME="New Game",e.START_GAME="Start Game",e))(f||{});const T=()=>({gameFunctions:["Start Game"],cardsToDiscard:[],hideHands:!0,gameOver:!1}),x=F("pokerAtom",T()),U=I(e=>{const a=e(x),s=e(A),r=e(D).slice(0,5);return{poker:a,turn:s,players:r}},(e,a,{poker:s,turn:r,players:n})=>{if(a(x,s),r&&a(A,r),n){const t=e(D);a(D,[...n,t[5],t[6]])}}),S=(e,a)=>{if(a.includes(4))return 7;const s=a.includes(3),r=a.indexOf(2),n=r!==-1;if(s&&n)return 6;if(s)return 3;if(n&&a.includes(2,r+1))return 2;if(n)return 1;const t=a.lastIndexOf(1)-a.indexOf(1)===4||a[12]&&a[0]&&a[1]&&a[2]&&a[3];let o=!0;for(let i=0;i<e.length;i+=1)if(e[i].suit!==e[0].suit){o=!1;break}return t&&o?8:o?5:t?4:0},w=e=>{const a=[0,0,0,0,0,0,0,0,0,0,0,0,0];return e.forEach(s=>{s&&(a[s.weight-2]+=1)}),a},W=e=>{const a=w(e),s=S(e,a),r=["0","0","0","0","0"];let n=0,t=4,o=0,i=-1;for(;n<5;){const d=a.indexOf(t,i+1);d===-1?(t-=1,i=-1):(r[o]=d.toString(14),o+=1,n+=t,i=d)}return`${s}${r.reduce((d,p)=>`${d}${p}`)}`},g=(e,a,s)=>{const r=[],n=[a.indexOf(1)];for(let t=1;t<e;t+=1)n[t]=a.indexOf(1,n[t-1]+1);for(let t=0;t<s.length;t+=1)for(let o=0;o<n.length;o+=1)if(s[t].weight-2===n[o]){r.push(t);break}return r},$=(e,a)=>{if(e.hands.length<1)return e;const s=e.hands[0].cards,r=w(s);switch(S(s,r)){case 0:{const t=r.lastIndexOf(1)>=11?g(4,r,s):[0,1,2,3,4];a(t,e);break}case 1:{const t=g(3,r,s);a(t,e);break}case 2:case 3:{const t=g(1,r,s);a(t,e);break}}},B=e=>{let a={val:0,id:0};e.forEach(s=>{if(s.hands[0]?.cards.length<1)return;const r=parseInt(W(s.hands[0].cards),14);r>a.val&&(a={val:r,id:s.id})}),e.forEach((s,r)=>{if(s.id===a.id){const n={...s,status:"win",money:s.money+20};e[r]=n}else{const n={...s,status:"lose",money:s.money-5};e[r]=n}})},J=()=>{const[{poker:{cardsToDiscard:e,gameFunctions:a,gameOver:s,hideHands:r},turn:n,players:t},o]=M(U),i=C(v),d=C(H),p=(c,u)=>{const{hands:l,id:h}=u,k=[...l[0].cards];c.sort().forEach((G,b)=>{k.splice(G-b,1)}),d(c.length,h,k)},N=()=>{if(!r&&!s&&t[n.player]?.isBot){const c=[...t];c.forEach((u,l)=>{n.player<=l&&$(u,p)}),B(c),o({poker:{cardsToDiscard:e,gameFunctions:[f.NEW_GAME],gameOver:!0,hideHands:r},players:c,turn:{player:0,hand:0}})}},R=()=>{i(),t.forEach(c=>{d(5,c.id)}),o({poker:{cardsToDiscard:e,gameFunctions:[f.DISCARD_CARDS],gameOver:s,hideHands:!1}})},_=(c,u,l)=>{p(l,c[u]),o({poker:{cardsToDiscard:[],gameFunctions:[f.END_TURN],gameOver:s,hideHands:r}})};return{checkUpdate:N,cardClickHandler:(c,u,l)=>{const h=[...e],k=h.indexOf(l);k===-1?h.push(l):h.splice(k,1),o({poker:{cardsToDiscard:h,gameFunctions:a,gameOver:s,hideHands:r}})},cardsToDiscard:e,gameFunctions:a,handleGameFunctionClick:c=>{const u=[];switch(c){case f.DISCARD_CARDS:_(t,n.player,e);break;case f.END_TURN:o({poker:{cardsToDiscard:[],gameFunctions:[f.DISCARD_CARDS],gameOver:s,hideHands:r},turn:{player:n.player+1,hand:0}});break;case f.NEW_GAME:t.forEach(l=>u.push({...l,status:"",hands:[],bet:5})),o({poker:T(),turn:{player:0,hand:0},players:u});break;case f.START_GAME:R();break;default:console.error("Unknown Game Function: ",c)}},gameOver:s,hideHands:r,players:t,turn:n}},y=E.memo(()=>m.jsxs("div",{className:"flex-container",children:[m.jsx(O,{variant:"h2",component:"h1",gutterBottom:!0,children:"5 Card Draw Poker"}),m.jsx(j,{})]}));y.displayName="Header";const V=E.memo(()=>{const{checkUpdate:e,cardClickHandler:a,cardsToDiscard:s,gameFunctions:r,handleGameFunctionClick:n,gameOver:t,hideHands:o,players:i,turn:d}=J();return e(),m.jsxs(m.Fragment,{children:[m.jsx(y,{}),m.jsx(P,{cardClickHandler:a,cardsToDiscard:s,gameFunctions:r,onClick:n,gameOver:t,hideHands:o,isBlackJack:!1,players:i,turn:d})]})});V.displayName="Poker";export{V as default};
//# sourceMappingURL=index-0XtYstdD.js.map
