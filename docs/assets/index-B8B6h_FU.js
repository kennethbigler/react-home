import{Q as ve,j as t,r as M,P as te,G as we,D as pe}from"./index-Bjpjl0gv.js";import{I as J}from"./InfoPopup-B79BOfBw.js";import{A as ce}from"./Add-CGNCAXiO.js";import{R as me}from"./Remove-DYBJfKMY.js";import{b as F,c as u,T as he,a as xe}from"./TableRow-BBQMPIlH.js";import{I as L,S as de,T as K}from"./Header-CpPh_A9d.js";import{T as be}from"./TableHead-CHOZpYhv.js";import{G as I}from"./Grid2-CI84ZOsv.js";import{B as ae}from"./Button-SCIzWuC8.js";import{H as ge,a as je}from"./highcharts-react.min-8JnSVU3D.js";import{C as V}from"./Chip-DIYor-Wx.js";import{A as O}from"./Avatar-C0o_V5Mw.js";import{p as Me,P as Ce}from"./PlayerMenu-c47dDmRg.js";import"./DialogTitle-JyNrcSVK.js";import"./useThemeProps-01Latb5z.js";import"./isMuiElement-ByuYgL3y.js";import"./Select-C_Hke6tV.js";import"./useSlotProps-FqJ1pwPb.js";import"./TextField-V5VyUviL.js";const Q=0,X=13,m={bid:3,blind:!1,train:!1},Ae={data:[],first:0,lastBid:[m,m,m,m],lifeBags:[0,0,0,0,0],missedBids:[0,0,0,0],wins1:0,wins2:0,total1:0,total2:0,nils:[[0,0,0],[0,0,0],[0,0,0],[0,0,0]]},fe=ve("spadesAtom",Ae),R=({id:e,blindTrade:s,canTrain:d,bid:a,blind:n,train:o,onBid:r})=>{const l=()=>r(Math.max(a-1,Q),!1,!1),h=()=>r(Math.min(a+1,X),!1,!1),g=(B,v)=>r(a,v,!1),b=(B,v)=>r(a,!1,v);return t.jsxs(F,{children:[t.jsx(u,{children:e}),t.jsxs(u,{align:"center",children:[t.jsx(L,{onClick:l,disabled:a<=Q,children:t.jsx(me,{})}),a,t.jsx(L,{onClick:h,disabled:a>=X,children:t.jsx(ce,{})})]}),t.jsxs(u,{align:"right",children:[t.jsx(de,{checked:n,slotProps:{input:{"aria-label":`P${e} Blind Nil`}},onChange:g,size:"small"}),s||n?s:""]}),t.jsx(u,{align:"right",children:d?t.jsx(de,{checked:o,slotProps:{input:{"aria-label":`P${e} Trains`}},onChange:b,size:"small"}):null})]})},_=(e,s)=>e<0&&(s===0||s===2)||e>0&&(s===1||s===3)?Math.min(Math.abs(e),3):0,Te=({blindTrade:e,first:s,initials:d,onBidSave:a})=>{const[n,o]=M.useState([m,m,m,m]),r=(s+0)%4,l=(s+1)%4,h=(s+2)%4,g=(s+3)%4,b=y=>(C,w,T)=>{let p={bid:C,blind:w,train:T};if(w)p={bid:0,blind:w,train:!1};else if(T){let c=10;switch(y){case r:c-=n[h].bid;break;case l:c-=n[g].bid;break;case h:c-=n[r].bid;break;case g:default:c-=n[l].bid}p={bid:c,blind:!1,train:T}}else p={bid:C,blind:!1,train:!1};const i=[...n];i[y]=p,o(i)},B=()=>{a(n),o([m,m,m,m])},v=n.reduce((y,C)=>y-C.bid,13);return t.jsx(J,{title:"+ Bid",onSave:B,children:t.jsxs(he,{"aria-label":"Bid Table",padding:"none",children:[t.jsx(be,{children:t.jsxs(F,{children:[t.jsx(u,{width:"20%",children:"P"}),t.jsxs(u,{width:"40%",align:"center",children:["Bid (",v," 💰)"]}),t.jsx(u,{width:"20%",align:"center",children:"🦮"}),t.jsx(u,{width:"20%",align:"center",children:"🚂"})]})}),t.jsxs(xe,{children:[t.jsx(R,{id:d[r]+" 🥇",...n[r],onBid:b(r),blindTrade:_(e,r)}),t.jsx(R,{id:d[l],...n[l],onBid:b(l),blindTrade:_(e,l)}),t.jsx(R,{canTrain:0<n[r].bid&&n[r].bid<10,id:d[h],...n[h],blindTrade:_(e,h),onBid:b(h)}),t.jsx(R,{canTrain:0<n[l].bid&&n[l].bid<10,id:d[g]+" 🃏",...n[g],blindTrade:_(e,g),onBid:b(g)})]})]})})},ke=({initials:e,onPenalty:s})=>t.jsx(J,{title:"Penalty",buttonVariant:"outlined",buttonColor:"error",children:t.jsxs(I,{container:!0,spacing:2,children:[t.jsx(I,{size:6,children:t.jsxs(ae,{fullWidth:!0,variant:"contained",color:"error",onClick:s(0),children:["Team ",e[0]+e[2]]})}),t.jsx(I,{size:6,children:t.jsxs(ae,{fullWidth:!0,variant:"contained",color:"error",onClick:s(1),children:["Team ",e[1]+e[3]]})})]})}),E=({initial:e,lastBid:s,made:d,setMade:a})=>{const n=()=>a(Math.max(d-1,Q)),o=()=>a(Math.min(d+1,X));return t.jsxs(I,{size:6,children:[t.jsxs(K,{children:[e," Bid: ",s]}),t.jsxs("div",{children:["Made:",t.jsx(L,{onClick:n,disabled:d<=Q,children:t.jsx(me,{})}),d,t.jsx(L,{onClick:o,disabled:d>=X,children:t.jsx(ce,{})})]})]})},Pe=({initials:e,lastBid:s,onScoreSave:d})=>{const[a,n]=M.useState(3),[o,r]=M.useState(3),[l,h]=M.useState(3),[g,b]=M.useState(3),B=a+o+l+g,y=B===13?()=>{d([a,o,l,g]),n(3),r(3),h(3),b(3)}:void 0;return t.jsxs(J,{title:"+ Score",onSave:y,children:[t.jsxs(K,{color:B===13?"success":"warning",align:"center",marginBottom:1,children:[B!==13&&"⚠️"," Tricks: ",B]}),t.jsxs(I,{container:!0,spacing:2,children:[t.jsx(E,{initial:e[0],lastBid:s[0].bid,made:a,setMade:n}),t.jsx(E,{initial:e[1],lastBid:s[1].bid,made:o,setMade:r}),t.jsx(E,{initial:e[2],lastBid:s[2].bid,made:l,setMade:h}),t.jsx(E,{initial:e[3],lastBid:s[3].bid,made:g,setMade:b})]})]})},ue=M.memo(({initials:e,lifeBags:s,missedBids:d,color:a})=>{const n=Math.round(s[s.length-1]),o={chart:{zooming:{type:"xy"},height:340,backgroundColor:null},credits:{enabled:!1},legend:{enabled:!1},plotOptions:{column:{pointPadding:0},series:{marker:{enabled:!1},lineWidth:2}},title:{text:"Bags",style:{color:a}},tooltip:{shared:!0},xAxis:{crosshair:!0,categories:e.split(""),lineColor:a,labels:{style:{color:a}}},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0},lineColor:a,labels:{style:{color:a}}},series:[{name:"💰",type:"column",data:s.slice(0,-1)},{name:"🎰",type:"column",data:d},{name:"✅",type:"spline",data:[n,n,n,n],color:a,lineWidth:5}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ge,{highcharts:je,options:o})})});ue.displayName="StatsBagsChart";const oe=e=>e.reduce((s,d)=>d.train?s+"🚂":d.blind?s+"🦮":d.bid===0?s+"🚫":d.bid>=10?s+`,${d.bid},`:s+d.bid.toString(),""),re=(e,s,d,a)=>{let n=0,o=0,r="";if(e.blind&&s.blind)e.made===0&&s.made===0?n=80:(o=e.made+s.made,r="🚫🚫");else if(e.bid===0&&s.bid===0)e.blind||s.blind?e.made===0&&s.made===0?n=60:e.blind&&e.made===0||s.blind&&s.made===0?(n=30,o=e.made+s.made,r="🚫"):e.made===0||s.made===0?(o=e.made+s.made,r="🚫"):(n=-30,o=e.made+s.made,r="🚫🚫"):e.made===0&&s.made===0?n=40:e.made===0||s.made===0?(o=e.made+s.made,r="🚫"):(n=-20,o=e.made+s.made,r="🚫🚫");else if(e.train||s.train)e.made+s.made>=10?(n=20,o=e.made+s.made-10):(n=-20,r="🚂");else{e.bid===0?e.made===0?n+=e.blind?20:10:(n-=10,o+=e.made,r="🚫"):s.bid===0&&(s.made===0?n+=s.blind?20:10:(n-=10,o+=s.made,r="🚫"));const l=e.bid+s.bid,h=(e.bid>0?e.made:0)+(s.bid>0?s.made:0);h>=l?(n+=l,o+=h-l):(n-=l,r+="🎰")}for(;a+o>=10;)n-=9,o-=10,r+="💰";return{score:d+n,bags:a+o,mod:r}},ie=(e,s,d)=>{let a=s+3,n=(d||"")+"😈",o=e;return a>=10&&(o-=9,a-=10,n+="💰"),{score:o,bags:a,mod:n}},q=(e,s)=>e===s?"default":e>s?"success":"error",Be=M.memo(({color:e,initials:s,nils:d})=>{const a={chart:{type:"column",height:340,backgroundColor:null},credits:{enabled:!1},legend:{padding:0,itemStyle:{color:e}},plotOptions:{column:{stacking:"normal",pointPadding:0}},title:{text:"Nils",style:{color:e}},xAxis:{categories:s.split(""),lineColor:e,labels:{style:{color:e}}},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0},lineColor:e,labels:{style:{color:e}}},series:[{name:"🚫",data:d.map(n=>n[0]-n[1]),stack:"Nils"},{name:"🦮",data:d.map(n=>n[1]),stack:"Nils"},{name:"🏅",data:d.map(n=>n[2]),stack:"Wins"}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ge,{highcharts:je,options:a})})});Be.displayName="StatsNilChart";const De=({initials:e})=>{const s=te(we),{total1:d,total2:a,nils:n,lifeBags:o,missedBids:r}=te(fe),l=s.mode==="light"?"black":"white";return t.jsx(J,{title:"Stats",buttonVariant:"outlined",buttonColor:"success",children:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex-container",style:{paddingBottom:15},children:[t.jsx(K,{children:"Totals:"}),t.jsx(V,{avatar:t.jsx(O,{children:e[0]+e[2]}),color:q(d,a),label:d}),t.jsx(V,{avatar:t.jsx(O,{children:e[1]+e[3]}),color:q(a,d),label:a})]}),t.jsx(ue,{color:l,initials:e,lifeBags:o,missedBids:r}),t.jsx(Be,{color:l,initials:e,nils:n})]})})},Ne=({blindTrade:e,first:s,initials:d,lastBid:a,showPenalty:n,onBidSave:o,onPenalty:r,onScoreSave:l})=>t.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[t.jsx(Te,{blindTrade:e,first:s,initials:d,onBidSave:o}),n&&t.jsx(ke,{initials:d,onPenalty:r}),t.jsx(De,{initials:d}),t.jsx(Pe,{initials:d,lastBid:a,onScoreSave:l})]}),le=(e,s)=>e===void 0||s===void 0||e===0?"":e>0?`${e>=100&&e>=s?"🎉 ":""}${e}`:`${e}0 + `,We=({initials:e,data:s})=>t.jsxs(he,{"aria-label":"Bid Table",children:[t.jsx(be,{children:t.jsxs(F,{children:[t.jsx(u,{width:"10%",children:"🥇"}),t.jsxs(u,{children:["Bid",t.jsx("br",{}),"(",e[0]+e[1]+e[2]+e[3],")"]}),t.jsx(u,{children:e[0]+e[2]}),t.jsx(u,{children:e[1]+e[3]})]})}),t.jsx(xe,{children:s.map((d,a)=>t.jsxs(F,{children:[t.jsxs(u,{padding:a===s.length-1?"none":void 0,align:"center",children:[d.start,a===s.length-1&&(d.score1?"🃏":"🥇")]}),t.jsx(u,{children:d.bid}),t.jsxs(u,{children:[le(d.score1,d.score2),d.bags1,d.mod1&&` (${d.mod1})`]}),t.jsxs(u,{children:[le(d.score2,d.score1),d.bags2,d.mod2&&` (${d.mod2})`]})]},a))})]}),$e=()=>{const e=te(Me),[s,d]=pe(fe),{data:a,first:n,lastBid:o,lifeBags:r,missedBids:l,wins1:h,wins2:g,total1:b,total2:B,nils:v}=s,y=e.reduce((i,c,j)=>j<4?i+c.name[0]:i,"");return{data:a,first:n,initials:y,lastBid:o,lifeBags:r,wins1:h,wins2:g,addBid:i=>{var j;if(a[a.length-1]&&((j=a[a.length-1])==null?void 0:j.score1)===void 0){const f=[...a];f[a.length-1].bid=oe(i),d({...s,data:f,lastBid:i});return}const c=[...a];c.push({start:y[n],bid:oe(i)}),d({...s,data:c,lastBid:i})},addPenalty:i=>()=>{var j;let c=a.length-1;if(((j=a[c])==null?void 0:j.score1)===void 0&&(c-=1),i===0){const{score1:f,bags1:S,mod1:k}=a[c]||{};if(f===void 0||S===void 0)return;const{score:P,bags:D,mod:N}=ie(f,S,k),A=[...a];A[c]={...a[c],score1:P,bags1:D,mod1:N},d({...s,data:A})}else{const{score2:f,bags2:S,mod2:k}=a[c]||{};if(f===void 0||S===void 0)return;const{score:P,bags:D,mod:N}=ie(f,S,k),A=[...a];A[c]={...a[c],score2:P,bags2:D,mod2:N},d({...s,data:A})}},addScore:i=>{var ne;if(((ne=a[a.length-1])==null?void 0:ne.score1)!==void 0)return;const c=[...a],{score1:j,bags1:f,score2:S,bags2:k}=a[a.length-2]||{},{score:P,bags:D,mod:N}=re({...o[0],made:i[0]},{...o[2],made:i[2]},j||0,f||0),{score:A,bags:Se,mod:ye}=re({...o[1],made:i[1]},{...o[3],made:i[3]},S||0,k||0);c[a.length-1]={...a[a.length-1],score1:P,bags1:D,mod1:N,score2:A,bags2:Se,mod2:ye};const z=[...v],G=n,H=(n+1)%4,W=(n+2)%4,$=(n+3)%4,U=[...r];o.forEach((Y,x)=>{z[x][0]+=o[x].bid===0?1:0,z[x][1]+=o[x].blind?1:0,z[x][2]+=o[x].bid===0&&i[x]===0?1:0;const Z=(x+2)%4,ee=Y.bid+o[Z].bid-(i[x]+i[Z]),se=Y.bid-i[x];Y.bid>2&&ee>0&&se>0&&(l[x]+=Math.min(se,ee)),!(x===G&&o[W].bid===0&&!o[W].blind||x===H&&o[$].bid===0&&!o[$].blind||(x===G||x===W)&&o[H].bid+o[$].bid>i[H]+i[$]||(x===H||x===$)&&o[G].bid+o[W].bid>i[G]+i[W]||o[x].train||o[Z].train)&&(U[x]+=Math.max(Math.min(-se,-ee),0))}),U[o.length]+=.25,d({...s,data:c,first:(n+1)%4,lastBid:[m,m,m,m],lifeBags:U,nils:z})},newGame:()=>{const{score1:i,bags1:c}=a[a.length-1],{score2:j,bags2:f}=a[a.length-1],S=i===j&&(c||0)>(f||0)||(i||0)>(j||0);d({...s,data:[],lastBid:[m,m,m,m],wins1:h+(S?1:0),wins2:g+(S?0:1),total1:b+(i||0)*10+(c||0),total2:B+(j||0)*10+(f||0)})}}},Ie=({initials:e,wins1:s,wins2:d})=>t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex-container",children:[t.jsx(K,{variant:"h2",component:"h1",children:"♠️🧮"}),t.jsx(V,{avatar:t.jsx(O,{children:e[0]+e[2]}),color:q(s,d),label:s}),t.jsx(V,{avatar:t.jsx(O,{children:e[1]+e[3]}),color:q(d,s),label:d}),t.jsx(Ce,{})]})}),ze=M.memo(()=>{var p,i,c,j,f,S;const{data:e,initials:s,wins1:d,wins2:a,newGame:n,first:o,lastBid:r,addBid:l,addPenalty:h,addScore:g}=$e();let b=e.length-1;((p=e[b])==null?void 0:p.score1)===void 0&&(b-=1);const B=((i=e[b])==null?void 0:i.score1)||0,v=((c=e[b])==null?void 0:c.bags1)||0,y=((j=e[b])==null?void 0:j.score2)||0,C=((f=e[b])==null?void 0:f.bags2)||0,w=B*10+v-(y*10+C),T=w>0?Math.floor(w/100):Math.ceil(w/100);return t.jsxs(t.Fragment,{children:[t.jsx(Ie,{initials:s,wins1:d,wins2:a}),B>=100||y>=100?t.jsx(ae,{fullWidth:!0,color:"error",onClick:n,variant:"contained",sx:{marginTop:2},children:"Reset"}):t.jsx(Ne,{blindTrade:T,first:o,initials:s,lastBid:r,showPenalty:((S=e[0])==null?void 0:S.score1)!==void 0,onBidSave:l,onPenalty:h,onScoreSave:g}),t.jsx(We,{initials:s,data:e})]})});ze.displayName="Spades";export{ze as default};
//# sourceMappingURL=index-B8B6h_FU.js.map
