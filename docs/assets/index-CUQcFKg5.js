import{O as E,j as a,r as S,M as L,A as W}from"./index-CLWmqEbq.js";import{p as F,P as H}from"./PlayerMenu-CPI52e94.js";import{I as k}from"./InfoPopup-C4FRMTCH.js";import{b as A,c as h,T as C,a as N}from"./TableRow-CTO2OGTP.js";import{S as D}from"./Slider-fcN67E76.js";import{S as M,T as _}from"./Header-BPtu2lHf.js";import{T as G}from"./TableHead-CkNDfeFC.js";import{G as I}from"./Grid2-Ci6Pqrgr.js";import{B as O}from"./Button-BuK4RTRF.js";import"./Select-CUVlQiQ8.js";import"./isMuiElement-BmdpaUU6.js";import"./useSlotProps-BGlftZfC.js";import"./useId-B9yqIk4L.js";import"./TextField-BwZ4CQqy.js";import"./DialogTitle-CcgGdTit.js";import"./visuallyHidden-Dan1xhjv.js";import"./useThemeProps-C0pa9_9K.js";const R=0,z=13,l={bid:0,blind:!1,train:!1},V={first:0,lastBid:[l,l,l,l],data:[]},X=E("spadesAtom",V),T=({id:e,canTrain:n,bid:d,blind:s,train:t,onBid:r})=>{const i=(c,m)=>{const j=Array.isArray(m)?m[0]:m;r(j,!1,!1)},o=(c,m)=>r(d,m,!1),x=(c,m)=>r(d,!1,m);return a.jsxs(A,{children:[a.jsxs(h,{children:[e," (",d,")"]}),a.jsx(h,{children:a.jsx(D,{"aria-label":`player ${e} bid`,min:R,max:z,value:d,valueLabelDisplay:"auto",onChange:i})}),a.jsx(h,{align:"right",children:a.jsx(M,{checked:s,inputProps:{"aria-label":`P${e} Blind Nil`},onChange:o,size:"small"})}),a.jsx(h,{align:"right",children:n?a.jsx(M,{checked:t,inputProps:{"aria-label":`P${e} Trains`},onChange:x,size:"small"}):null})]})},q=({first:e,initials:n,onBidSave:d})=>{const[s,t]=S.useState([l,l,l,l]),r=(e+0)%4,i=(e+1)%4,o=(e+2)%4,x=(e+3)%4,c=f=>(b,u,w)=>{let g={bid:b,blind:u,train:w};if(u)g={bid:0,blind:u,train:!1};else if(w){let B=10;switch(f){case r:B-=s[o].bid;break;case i:B-=s[x].bid;break;case o:B-=s[r].bid;break;case x:default:B-=s[i].bid}g={bid:B,blind:!1,train:w}}else g={bid:b,blind:!1,train:!1};const y=[...s];y[f]=g,t(y)},m=()=>{d(s),t([l,l,l,l])},j=s.reduce((f,b)=>f-b.bid,13);return a.jsx(k,{title:"+ Bid",onSave:m,children:a.jsxs(C,{"aria-label":"Bid Table",padding:"none",children:[a.jsx(G,{children:a.jsxs(A,{children:[a.jsx(h,{width:"20%",children:"P"}),a.jsxs(h,{width:"50%",children:["Bid (",j," Bag",j!==1?"s":"",")"]}),a.jsx(h,{width:"15%",align:"center",children:"🦮"}),a.jsx(h,{width:"15%",align:"center",children:"🚂"})]})}),a.jsxs(N,{children:[a.jsx(T,{id:n[r],...s[r],onBid:c(r)}),a.jsx(T,{id:n[i],...s[i],onBid:c(i)}),a.jsx(T,{canTrain:0<s[r].bid&&s[r].bid<10,id:n[o],...s[o],onBid:c(o)}),a.jsx(T,{canTrain:0<s[i].bid&&s[i].bid<10,id:n[x],...s[x],onBid:c(x)})]})]})})},v=({initial:e,lastBid:n,made:d,setMade:s})=>{const t=(r,i)=>{const o=Array.isArray(i)?i[0]:i;s(o)};return a.jsxs(I,{size:6,children:[a.jsxs("div",{children:[e," Bid: ",n]}),a.jsxs("div",{children:["Made: ",d]}),a.jsx(D,{"aria-label":"player 0 made",min:R,max:z,value:d,valueLabelDisplay:"auto",onChange:t})]})},J=({initials:e,lastBid:n,onScoreSave:d})=>{const[s,t]=S.useState(3),[r,i]=S.useState(3),[o,x]=S.useState(3),[c,m]=S.useState(3),j=s+r+o+c,b=j===13?()=>{d([s,r,o,c]),t(3),i(3),x(3),m(3)}:void 0;return a.jsxs(k,{title:"+ Score",onSave:b,children:[a.jsxs(_,{color:j===13?"success":"warning",align:"center",marginBottom:1,children:[j!==13&&"⚠️"," Tricks: ",j]}),a.jsxs(I,{container:!0,spacing:2,children:[a.jsx(v,{initial:e[0],lastBid:n[0].bid,made:s,setMade:t}),a.jsx(v,{initial:e[1],lastBid:n[1].bid,made:r,setMade:i}),a.jsx(v,{initial:e[2],lastBid:n[2].bid,made:o,setMade:x}),a.jsx(v,{initial:e[3],lastBid:n[3].bid,made:c,setMade:m})]})]})},K=({first:e,initials:n,lastBid:d,onBidSave:s,onScoreSave:t})=>a.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[a.jsx(q,{first:e,initials:n,onBidSave:s}),a.jsx(J,{initials:n,lastBid:d,onScoreSave:t})]}),P=e=>e===void 0||e===0?"":e>0?`${e>100?"🎉 ":""}${e}`:`${e}0 + `,Q=({initials:e,data:n})=>a.jsxs(C,{"aria-label":"Bid Table",children:[a.jsx(G,{children:a.jsxs(A,{children:[a.jsx(h,{width:"10%",children:"🥇"}),a.jsxs(h,{children:["Bid",a.jsx("br",{}),"(",e[0]+e[1]+e[2]+e[3],")"]}),a.jsx(h,{children:e[0]+e[2]}),a.jsx(h,{children:e[1]+e[3]})]})}),a.jsx(N,{children:n.map((d,s)=>a.jsxs(A,{children:[a.jsx(h,{children:d.start}),a.jsx(h,{children:d.bid}),a.jsxs(h,{children:[P(d.score1),d.bags1]}),a.jsxs(h,{children:[P(d.score2),d.bags2]})]},s))})]}),$=(e,n,d,s)=>{if(e.blind&&n.blind)return e.made===0&&n.made===0?{score:d+80,bags:s}:{score:d,bags:s+e.made+n.made};if(e.bid===0&&n.bid===0)return e.made===0&&n.made===0?{score:d+40,bags:s}:e.made===0||n.made===0?{score:d,bags:s+e.made+n.made}:{score:d-20,bags:s+e.made+n.made};let t=0,r=0;if((e.train||n.train)&&e.made+n.made>=10)t=20,r=e.made+n.made-10;else{e.bid===0?e.made===0?t+=e.blind?20:10:(t-=10,r+=e.made):n.bid===0&&(n.made===0?t+=n.blind?20:10:(t-=10,r+=n.made));const i=e.bid+n.bid,o=(e.bid>0?e.made:0)+(n.bid>0?n.made:0);o>=i?(t+=i,r+=o-i):t-=i}return s+r>=10&&(t-=9,r-=10),{score:d+t,bags:s+r}},U=()=>{const e=L(F),[{first:n,lastBid:d,data:s},t]=W(X),r=[e[0].name[0],e[1].name[0],e[2].name[0],e[3].name[0]];return{first:n,lastBid:d,data:s,initials:r,addBid:c=>{var f;if(s[s.length-1]&&((f=s[s.length-1])==null?void 0:f.score1)===void 0)return;const m=[...s],j={start:r[n],bid:c.reduce((b,u)=>u.train?b+"🚂":u.blind?b+"🦮":u.bid===0?b+"🚫":u.bid>=10?b+`,${u.bid},`:b+u.bid.toString(),"")};m.push(j),t({first:n,lastBid:c,data:m})},addScore:c=>{var p;if(((p=s[s.length-1])==null?void 0:p.score1)!==void 0)return;const m=[...s],{score1:j,bags1:f,score2:b,bags2:u}=s[s.length-2]||{},{score:w,bags:g}=$({...d[0],made:c[0]},{...d[2],made:c[2]},j||0,f||0),{score:y,bags:B}=$({...d[1],made:c[1]},{...d[3],made:c[3]},b||0,u||0);m[s.length-1]={...s[s.length-1],score1:w,bags1:g,score2:y,bags2:B},t({first:(n+1)%4,lastBid:[l,l,l,l],data:m})},newGame:()=>t({first:n,lastBid:[l,l,l,l],data:[]})}},Y=S.memo(()=>{var o,x;const{first:e,lastBid:n,data:d,initials:s,addBid:t,addScore:r,newGame:i}=U();return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-container",children:[a.jsx(_,{variant:"h2",component:"h1",children:"♠️ Scores"}),a.jsx(H,{})]}),(((o=d[d.length-1])==null?void 0:o.score1)||0)>=100||(((x=d[d.length-1])==null?void 0:x.score2)||0)>=100?a.jsx(O,{fullWidth:!0,color:"error",onClick:i,variant:"contained",sx:{marginTop:2},children:"Reset"}):a.jsx(K,{first:e,initials:s,lastBid:n,onBidSave:t,onScoreSave:r}),a.jsx(Q,{initials:s,data:d})]})});Y.displayName="Spades";export{Y as default};
//# sourceMappingURL=index-CUQcFKg5.js.map
