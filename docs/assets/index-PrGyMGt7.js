import{r as T,j as e,O as X,P as A,W as K,A as Q,M as Z}from"./index-DhVGG_NW.js";import{T as ee}from"./TableHead-KhbECTcR.js";import{b as w,c as i,T as te,a as ne}from"./TableRow-DHQ5-GZA.js";import{B as k}from"./Button-Dj3HxRuo.js";import{P as oe,p as C}from"./PlayerMenu-GYxIq9U-.js";import{T as v}from"./Header-_9woOApa.js";import"./Select-CB1fBJ4I.js";import"./isMuiElement-Ck9jPB8g.js";import"./useSlotProps-kF76sogf.js";import"./useId-CPd3QfSM.js";import"./Grid2-YuZ42mY6.js";import"./useThemeProps-CYeelXC8.js";import"./TextField-B9k9V_fq.js";const se=()=>Math.floor(Math.random()*6)+1,re={roll(){return se()}},Y=T.memo(({sx:t})=>e.jsx(ee,{children:e.jsxs(w,{sx:{borderBottom:2},children:[e.jsx(i,{children:"Minimum Required for Bonus"}),e.jsx(i,{children:"How to Score"}),e.jsx(i,{sx:t,children:"Game Score"})]})}));Y.displayName="Header";const D=T.memo(({topSum:t,finalTopSum:n,sx:o})=>e.jsxs(e.Fragment,{children:[e.jsxs(w,{sx:{borderTop:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Total == 63"}),e.jsx(i,{sx:o,children:t})]}),e.jsxs(w,{children:[e.jsx(i,{component:"th",scope:"row",children:"Bonus if >= 63"}),e.jsx(i,{children:"Score 35"}),e.jsx(i,{sx:o,children:t%100>=63?35:0})]}),e.jsxs(w,{sx:{borderBottom:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Upper Half Total"}),e.jsx(i,{sx:o,children:n})]})]}));D.displayName="TopScores";const $=()=>(t,n)=>(t[n]?t[n]+=1:t[n]=1,t),H=(t,n)=>{const o=t.reduce($(),{});let s=!1;return Object.values(o).forEach(c=>{c>=n&&(s=!0)}),s},ce=t=>{const n=t.reduce($(),{});let o=!1,s=!1;return Object.values(n).forEach(c=>{c>=3?o=!0:c>=2&&(s=!0)}),o&&s},_=(t,n)=>{const o=t.reduce($(),{});let s=0;return[1,2,3,4,5,6].forEach(l=>{s<n&&(o[l]?s+=1:s=0)}),s>=n},ae=(t,n)=>Object.entries(t.reduce($(),{})).reduce((o,[s,c])=>c===5&&n[Number(s)-1].score>=0?!0:o,!1),le=({bottom:t,values:n,showScoreButtons:o,getScoreButton:s,top:c,sx:l,topSum:p,finalTopSum:r})=>{const a=x=>n.reduce((h,b)=>(b===x&&(h[0]+=1,h[1]+=x),h),[0,0]),d=t[5].score>0&&H(n,5),y=(x,h,b,S)=>x>=0?x:o?s(h,d?b+100:b,!0,S):null;return e.jsxs(e.Fragment,{children:[c.map(({name:x,score:h},b)=>{const S=b+1,[B,g]=a(S),R=B>=1;return e.jsxs(w,{children:[e.jsx(i,{component:"th",scope:"row",children:`${x}: ${S},${S},${S} = ${S*3}`}),e.jsx(i,{children:`Add Only ${x}`}),e.jsx(i,{sx:l,children:y(h,R,g,b)})]},x)}),e.jsx(D,{topSum:p,finalTopSum:r,sx:l})]})},z="Sum of Dice",O=T.memo(({finalTopSum:t,bottomSum:n,sx:o})=>e.jsxs(e.Fragment,{children:[e.jsxs(w,{sx:{borderTop:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Lower Half Total"}),e.jsx(i,{sx:o,children:n})]}),e.jsxs(w,{children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Upper Half Total"}),e.jsx(i,{sx:o,children:t})]}),e.jsxs(w,{sx:{borderBottom:2},children:[e.jsx(i,{colSpan:2,component:"th",scope:"row",children:"Grand Total"}),e.jsx(i,{sx:o,children:t+n})]})]}));O.displayName="BottomScores";const ie=t=>t.reduce((n,o)=>n+o,0),de=(t,n)=>{switch(t){case 0:return H(n,3);case 1:return H(n,4);case 2:return ce(n);case 3:return _(n,4);case 4:return _(n,5);case 5:return H(n,5);case 6:return!0;default:return console.error("Unexpected Value"),!1}},he=({values:t,showScoreButtons:n,getScoreButton:o,top:s,bottom:c,sx:l,finalTopSum:p,bottomSum:r})=>{const a=T.useCallback((d,y,x,h)=>d>=0?d:n?x&&ae(t,s)?o(!0,y+100,!1,h):o(de(h,t),y,!1,h):null,[o,n,s,t]),m=T.useCallback(()=>{const d=c[5].score>0;return c.map((y,x)=>{const{name:h,hint:b,points:S,score:B}=y,g=S===z?ie(t):S;return e.jsxs(w,{children:[e.jsx(i,{component:"th",scope:"row",children:h}),e.jsx(i,{children:b}),e.jsx(i,{sx:l,children:a(B,g,d,x)})]},h)})},[c,a,l,t]);return e.jsxs(e.Fragment,{children:[m(),e.jsx(O,{bottomSum:r,finalTopSum:p,sx:l})]})},N={textAlign:"center"},me=({bottom:t,bottomSum:n,finalTopSum:o,showScoreButtons:s,top:c,topSum:l,values:p,onTopScore:r,onBottomScore:a})=>{const m=T.useCallback((d,y,x,h)=>d?e.jsx(k,{color:"secondary",variant:"outlined",onClick:x?()=>r(y,h):()=>a(y,h),children:`Add ${y} Points`}):e.jsx(k,{color:"secondary",variant:"outlined",onClick:x?()=>r(0,h):()=>a(0,h),children:"0"}),[a,r]);return e.jsxs(te,{size:"small","aria-label":"yahtzee game table",children:[e.jsx(Y,{sx:N}),e.jsxs(ne,{children:[e.jsx(le,{finalTopSum:o,getScoreButton:m,showScoreButtons:s,sx:N,top:c,values:p,bottom:t,topSum:l}),e.jsx(he,{finalTopSum:o,getScoreButton:m,showScoreButtons:s,sx:N,top:c,values:p,bottom:t,bottomSum:n})]})]})},E=T.memo(({bestScore:t,lastScore:n,money:o,name:s})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-container",children:[e.jsx(v,{variant:"h2",component:"h1",children:"Yahtzee"}),e.jsx(oe,{})]}),e.jsxs("div",{className:"flex-container",children:[e.jsxs(v,{variant:"h4",component:"h2",children:[s,": $",o]}),e.jsx(v,{variant:"h4",children:`Best: ${t}`}),e.jsx(v,{variant:"h4",children:`Last: ${n}`})]})]}));E.displayName="Header";const ue={display:"block",margin:"auto",width:320},pe=({values:t,saved:n,roll:o,handleUnsave:s,handleSave:c,handleDiceRoll:l,getButtonText:p})=>e.jsxs("div",{className:"flex-container",children:[e.jsx(v,{variant:"h4",component:"h3",children:`Roll #${o}/3`}),e.jsxs("div",{style:ue,children:[n.map((r,a)=>e.jsx(k,{variant:"contained",onClick:()=>s(a),children:r},a)),t.map((r,a)=>e.jsx(k,{color:"secondary",variant:"outlined",onClick:()=>c(a),children:r},a))]}),e.jsx(k,{onClick:l,variant:"contained",disabled:o===3,children:p(o)})]}),P=()=>({roll:0,values:[0,0,0,0,0],saved:[],turn:0,showScoreButtons:!1,topScores:[-1,-1,-1,-1,-1,-1],bottomScores:[-1,-1,-1,-1,-1,-1,-1]}),F=X({key:"yahtzeeAtom",default:JSON.parse(localStorage.getItem("yahtzee-atom")||"null")||{...P(),bestScore:0,lastScore:0},effects:[({onSet:t})=>{t(n=>{localStorage.setItem("yahtzee-atom",JSON.stringify(n))})}]}),xe=A({key:"yahtzeeReadOnlyState",get:({get:t})=>{const{topScores:n,bottomScores:o}=t(F),{name:s}=t(C)[0];let c=0;const l=n.reduce((m,d)=>(d>=0&&(c+=1,m+=d),m),0),p=o.reduce((m,d)=>(d>=0&&(c+=1,m+=d),m),0);let r=l;l>=63&&(r+=35);const a=c>=13;return{topSum:l,bottomSum:p,finalTopSum:r,finish:a,name:s}}}),je=A({key:"yahtzeeState",get:({get:t})=>{const n=t(F),{money:o}=t(C)[0];return{...n,money:o}},set:({get:t,set:n},o)=>{if(!(o instanceof K)){const{money:s,...c}=o;n(F,c);const l=t(C),p=[...l];p[0]={...l[0],money:s},n(C,p)}}}),fe=()=>{const[t,n]=Q(je);return{state:t,newGame:r=>n({...P(),lastScore:r,bestScore:r>t.bestScore?r:t.bestScore,money:t.money+Math.ceil(r/10)}),diceClick:(r,a)=>n({...t,values:r,saved:a}),updateTop:r=>n({...t,topScores:r,showScoreButtons:!1,roll:0,values:[0,0,0,0,0],saved:[]}),updateBottom:r=>n({...t,bottomScores:r,showScoreButtons:!1,roll:0,values:[0,0,0,0,0],saved:[]}),updateRoll:(r,a,m,d)=>n({...t,values:r,saved:a,roll:m,showScoreButtons:!0,money:d?t.money-25:t.money})}},Se=[{name:"Aces"},{name:"Twos"},{name:"Threes"},{name:"Fours"},{name:"Fives"},{name:"Sixes"}],ye=[{name:"3 of a kind",hint:z,points:z},{name:"4 of a kind",hint:z,points:z},{name:"Full House",hint:"Score 25",points:25},{name:"Sm. Straight (4)",hint:"Score 30",points:30},{name:"Lg. Straight (5)",hint:"Score 40",points:40},{name:"Yahtzee",hint:"Score 50",points:50},{name:"Chance",hint:z,points:z}],be=T.memo(()=>{const{state:t,diceClick:n,newGame:o,updateTop:s,updateBottom:c,updateRoll:l}=fe(),{topScores:p,bottomScores:r,values:a,saved:m,roll:d,showScoreButtons:y,bestScore:x,lastScore:h,money:b}=t,{topSum:S,bottomSum:B,finalTopSum:g,finish:R,name:G}=Z(xe),M=()=>{if(R){o(g+B);return}if(d>=3)return;const u=[...a],j=[...m];for(let f=0;f<u.length;f+=1)u[f]=re.roll();u.sort(),j.sort(),l(u,j,d+1,B+S===0&&d===0)},I=u=>{if(a[u]===0)return;const j=[...a],f=[...m];f.push(j.splice(u,1)[0]),f.sort(),n(j,f)},V=u=>{const j=[...a],f=[...m];j.push(f.splice(u,1)[0]),j.sort(),n(j,f)},L=T.useCallback(u=>{if(R)return"New Game";switch(u){case 0:return"First Roll";case 1:return"Second Roll";case 2:return"Last Roll";case 3:return"Score";default:return"Error"}},[R]),U=(u,j)=>{const f=[...p];f[j]=u,s(f)},J=(u,j)=>{const f=[...r];f[j]=u,c(f)},q=p.map((u,j)=>({...Se[j],score:u})),W=r.map((u,j)=>({...ye[j],score:u}));return e.jsxs(e.Fragment,{children:[e.jsx(E,{bestScore:x,lastScore:h,money:b,name:G}),e.jsx("hr",{"aria-hidden":!0}),e.jsx(pe,{values:a,saved:m,roll:d,handleUnsave:V,handleSave:I,handleDiceRoll:M,getButtonText:L}),e.jsx("hr",{"aria-hidden":!0}),e.jsx(v,{variant:"h4",children:`Total: ${g+B}`}),e.jsx(me,{values:[...m,...a],bottom:W,top:q,onTopScore:U,onBottomScore:J,showScoreButtons:y,topSum:S,finalTopSum:g,bottomSum:B})]})});be.displayName="Yahtzee";export{be as default};
//# sourceMappingURL=index-PrGyMGt7.js.map
