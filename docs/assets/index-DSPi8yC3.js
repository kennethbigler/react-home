import{O as F,j as e,r as S,M as H,A as O}from"./index-CWoWB2WW.js";import{p as V,P as X}from"./PlayerMenu-BkpRZxg9.js";import{I as G}from"./InfoPopup-DMZCo6oZ.js";import{A as N}from"./Add-C5ZoZeeQ.js";import{R as D}from"./Remove-ByElrjjY.js";import{b as A,c as m,T as _,a as z}from"./TableRow-DdH-zj7f.js";import{I as k,S as I,T as P}from"./Header-Dq5-GgRb.js";import{T as E}from"./TableHead-CH7ywrE4.js";import{G as W}from"./Grid2-BYA6TWzC.js";import{B as q}from"./Button-C-a-IkrZ.js";import"./Select-BhlBOQCu.js";import"./isMuiElement-CLz3xx77.js";import"./useSlotProps-DrNiiZzO.js";import"./useId-BmYjkXtU.js";import"./TextField-ZLAG5U01.js";import"./DialogTitle-BPgDNxoB.js";import"./useThemeProps-BXhJkYSc.js";const y=0,p=13,o={bid:3,blind:!1,train:!1},J={first:0,lastBid:[o,o,o,o],data:[]},K=F("spadesAtom",J),T=({id:s,canTrain:n,bid:d,blind:a,train:r,onBid:t})=>{const i=()=>t(Math.max(d-1,y),!1,!1),l=()=>t(Math.min(d+1,p),!1,!1),x=(b,h)=>t(d,h,!1),c=(b,h)=>t(d,!1,h);return e.jsxs(A,{children:[e.jsx(m,{children:s}),e.jsxs(m,{align:"center",children:[e.jsx(k,{onClick:i,disabled:d<=y,children:e.jsx(D,{})}),d,e.jsx(k,{onClick:l,disabled:d>=p,children:e.jsx(N,{})})]}),e.jsx(m,{align:"right",children:e.jsx(I,{checked:a,inputProps:{"aria-label":`P${s} Blind Nil`},onChange:x,size:"small"})}),e.jsx(m,{align:"right",children:n?e.jsx(I,{checked:r,inputProps:{"aria-label":`P${s} Trains`},onChange:c,size:"small"}):null})]})},L=({first:s,initials:n,onBidSave:d})=>{const[a,r]=S.useState([o,o,o,o]),t=(s+0)%4,i=(s+1)%4,l=(s+2)%4,x=(s+3)%4,c=u=>(j,f,w)=>{let g={bid:j,blind:f,train:w};if(f)g={bid:0,blind:f,train:!1};else if(w){let B=10;switch(u){case t:B-=a[l].bid;break;case i:B-=a[x].bid;break;case l:B-=a[t].bid;break;case x:default:B-=a[i].bid}g={bid:B,blind:!1,train:w}}else g={bid:j,blind:!1,train:!1};const M=[...a];M[u]=g,r(M)},b=()=>{d(a),r([o,o,o,o])},h=a.reduce((u,j)=>u-j.bid,13);return e.jsx(G,{title:"+ Bid",onSave:b,children:e.jsxs(_,{"aria-label":"Bid Table",padding:"none",children:[e.jsx(E,{children:e.jsxs(A,{children:[e.jsx(m,{width:"20%",children:"P"}),e.jsxs(m,{width:"40%",align:"center",children:["Bid (",h," Bag",h!==1?"s":"",")"]}),e.jsx(m,{width:"20%",align:"center",children:"🦮"}),e.jsx(m,{width:"20%",align:"center",children:"🚂"})]})}),e.jsxs(z,{children:[e.jsx(T,{id:n[t],...a[t],onBid:c(t)}),e.jsx(T,{id:n[i],...a[i],onBid:c(i)}),e.jsx(T,{canTrain:0<a[t].bid&&a[t].bid<10,id:n[l],...a[l],onBid:c(l)}),e.jsx(T,{canTrain:0<a[i].bid&&a[i].bid<10,id:n[x],...a[x],onBid:c(x)})]})]})})},v=({initial:s,lastBid:n,made:d,setMade:a})=>{const r=()=>a(Math.max(d-1,y)),t=()=>a(Math.min(d+1,p));return e.jsxs(W,{size:6,children:[e.jsxs(P,{children:[s," Bid: ",n]}),e.jsxs("div",{children:["Made:",e.jsx(k,{onClick:r,disabled:d<=y,children:e.jsx(D,{})}),d,e.jsx(k,{onClick:t,disabled:d>=p,children:e.jsx(N,{})})]})]})},Q=({initials:s,lastBid:n,onScoreSave:d})=>{const[a,r]=S.useState(3),[t,i]=S.useState(3),[l,x]=S.useState(3),[c,b]=S.useState(3),h=a+t+l+c,j=h===13?()=>{d([a,t,l,c]),r(3),i(3),x(3),b(3)}:void 0;return e.jsxs(G,{title:"+ Score",onSave:j,children:[e.jsxs(P,{color:h===13?"success":"warning",align:"center",marginBottom:1,children:[h!==13&&"⚠️"," Tricks: ",h]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(v,{initial:s[0],lastBid:n[0].bid,made:a,setMade:r}),e.jsx(v,{initial:s[1],lastBid:n[1].bid,made:t,setMade:i}),e.jsx(v,{initial:s[2],lastBid:n[2].bid,made:l,setMade:x}),e.jsx(v,{initial:s[3],lastBid:n[3].bid,made:c,setMade:b})]})]})},U=({first:s,initials:n,lastBid:d,onBidSave:a,onScoreSave:r})=>e.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[e.jsx(L,{first:s,initials:n,onBidSave:a}),e.jsx(Q,{initials:n,lastBid:d,onScoreSave:r})]}),R=s=>s===void 0||s===0?"":s>0?`${s>100?"🎉 ":""}${s}`:`${s}0 + `,Y=({initials:s,data:n})=>e.jsxs(_,{"aria-label":"Bid Table",children:[e.jsx(E,{children:e.jsxs(A,{children:[e.jsx(m,{width:"10%",children:"🥇"}),e.jsxs(m,{children:["Bid",e.jsx("br",{}),"(",s[0]+s[1]+s[2]+s[3],")"]}),e.jsx(m,{children:s[0]+s[2]}),e.jsx(m,{children:s[1]+s[3]})]})}),e.jsx(z,{children:n.map((d,a)=>e.jsxs(A,{children:[e.jsx(m,{children:d.start}),e.jsx(m,{children:d.bid}),e.jsxs(m,{children:[R(d.score1),d.bags1]}),e.jsxs(m,{children:[R(d.score2),d.bags2]})]},a))})]}),$=(s,n,d,a)=>{if(s.blind&&n.blind)return s.made===0&&n.made===0?{score:d+80,bags:a}:{score:d,bags:a+s.made+n.made};if(s.bid===0&&n.bid===0)return s.made===0&&n.made===0?{score:d+40,bags:a}:s.made===0||n.made===0?{score:d,bags:a+s.made+n.made}:{score:d-20,bags:a+s.made+n.made};let r=0,t=0;if((s.train||n.train)&&s.made+n.made>=10)r=20,t=s.made+n.made-10;else{s.bid===0?s.made===0?r+=s.blind?20:10:(r-=10,t+=s.made):n.bid===0&&(n.made===0?r+=n.blind?20:10:(r-=10,t+=n.made));const i=s.bid+n.bid,l=(s.bid>0?s.made:0)+(n.bid>0?n.made:0);l>=i?(r+=i,t+=l-i):r-=i}return a+t>=10&&(r-=9,t-=10),{score:d+r,bags:a+t}},Z=()=>{const s=H(V),[{first:n,lastBid:d,data:a},r]=O(K),t=[s[0].name[0],s[1].name[0],s[2].name[0],s[3].name[0]];return{first:n,lastBid:d,data:a,initials:t,addBid:c=>{var u;if(a[a.length-1]&&((u=a[a.length-1])==null?void 0:u.score1)===void 0)return;const b=[...a],h={start:t[n],bid:c.reduce((j,f)=>f.train?j+"🚂":f.blind?j+"🦮":f.bid===0?j+"🚫":f.bid>=10?j+`,${f.bid},`:j+f.bid.toString(),"")};b.push(h),r({first:n,lastBid:c,data:b})},addScore:c=>{var C;if(((C=a[a.length-1])==null?void 0:C.score1)!==void 0)return;const b=[...a],{score1:h,bags1:u,score2:j,bags2:f}=a[a.length-2]||{},{score:w,bags:g}=$({...d[0],made:c[0]},{...d[2],made:c[2]},h||0,u||0),{score:M,bags:B}=$({...d[1],made:c[1]},{...d[3],made:c[3]},j||0,f||0);b[a.length-1]={...a[a.length-1],score1:w,bags1:g,score2:M,bags2:B},r({first:(n+1)%4,lastBid:[o,o,o,o],data:b})},newGame:()=>r({first:n,lastBid:[o,o,o,o],data:[]})}},ee=S.memo(()=>{var l,x;const{first:s,lastBid:n,data:d,initials:a,addBid:r,addScore:t,newGame:i}=Z();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-container",children:[e.jsx(P,{variant:"h2",component:"h1",children:"♠️ Scores"}),e.jsx(X,{})]}),(((l=d[d.length-1])==null?void 0:l.score1)||0)>=100||(((x=d[d.length-1])==null?void 0:x.score2)||0)>=100?e.jsx(q,{fullWidth:!0,color:"error",onClick:i,variant:"contained",sx:{marginTop:2},children:"Reset"}):e.jsx(U,{first:s,initials:a,lastBid:n,onBidSave:r,onScoreSave:t}),e.jsx(Y,{initials:a,data:d})]})});ee.displayName="Spades";export{ee as default};
//# sourceMappingURL=index-DSPi8yC3.js.map
