import{j as t,Z as H,_ as y,I as E,ab as U,ac as ee,h as Z,X as se,a0 as te,Y as ae,p as D,n as X,f as F,P as R,a5 as _}from"./mui-vendor-BMK_6B8Y.js";import{r as k}from"./react-vendor-CKArmg6J.js";import{I as V}from"./InfoPopup-87Ep8nnl.js";import{b as be,a as Y,t as ge,u as je}from"./index-CYYRZzpO.js";import{H as ne,a as de}from"./highcharts-react.min-DLqhRggN.js";import{p as ue,P as fe}from"./PlayerMenu-zZ89V6KO.js";import"./charts-COnJs7U_.js";const G=0,L=13,g={bid:3,blind:!1,train:!1},ye={data:[],first:0,lastBid:[g,g,g,g],lifeBags:[0,0,0,0,0],missedBids:[0,0,0,0],wins1:0,wins2:0,total1:0,total2:0,nils:[[0,0,0],[0,0,0],[0,0,0],[0,0,0]]},ie=be("spadesAtom",ye),W=({id:e,blindTrade:s,canTrain:d,bid:a,blind:n,train:i,onBid:o})=>{const c=()=>o(Math.max(a-1,G),!1,!1),h=()=>o(Math.min(a+1,L),!1,!1),x=(j,f)=>o(a,f,!1),m=(j,f)=>o(a,!1,f);return t.jsxs(H,{children:[t.jsx(y,{children:e}),t.jsxs(y,{align:"center",children:[t.jsx(E,{onClick:c,disabled:a<=G,children:t.jsx(U,{})}),a,t.jsx(E,{onClick:h,disabled:a>=L,children:t.jsx(ee,{})})]}),t.jsxs(y,{align:"right",children:[t.jsx(Z,{checked:n,slotProps:{input:{"aria-label":`P${e} Blind Nil`}},onChange:x,size:"small"}),s||n?s:""]}),t.jsx(y,{align:"right",children:d?t.jsx(Z,{checked:i,slotProps:{input:{"aria-label":`P${e} Trains`}},onChange:m,size:"small"}):null})]})},$=(e,s)=>e<0&&(s===0||s===2)||e>0&&(s===1||s===3)?Math.min(Math.abs(e),3):0,Be=({blindTrade:e,first:s,initials:d,onBidSave:a})=>{const[n,i]=k.useState([g,g,g,g]),o=(s+0)%4,c=(s+1)%4,h=(s+2)%4,x=(s+3)%4,m=B=>(v,w,M)=>{let S={bid:v,blind:w,train:M};if(w)S={bid:0,blind:w,train:!1};else if(M){let r=10;switch(B){case o:r-=n[h].bid;break;case c:r-=n[x].bid;break;case h:r-=n[o].bid;break;case x:default:r-=n[c].bid}S={bid:r,blind:!1,train:M}}else S={bid:v,blind:!1,train:!1};const l=[...n];l[B]=S,i(l)},j=()=>{a(n),i([g,g,g,g])},f=n.reduce((B,v)=>B-v.bid,13);return t.jsx(V,{title:"+ Bid",onSave:j,children:t.jsxs(se,{"aria-label":"Bid Table",padding:"none",children:[t.jsx(te,{children:t.jsxs(H,{children:[t.jsx(y,{width:"20%",children:"P"}),t.jsxs(y,{width:"40%",align:"center",children:["Bid (",f," ðŸ’°)"]}),t.jsx(y,{width:"20%",align:"center",children:"ðŸ¦®"}),t.jsx(y,{width:"20%",align:"center",children:"ðŸš‚"})]})}),t.jsxs(ae,{children:[t.jsx(W,{id:d[o]+" ðŸ¥‡",...n[o],onBid:m(o),blindTrade:$(e,o)}),t.jsx(W,{id:d[c],...n[c],onBid:m(c),blindTrade:$(e,c)}),t.jsx(W,{canTrain:0<n[o].bid&&n[o].bid<10,id:d[h],...n[h],blindTrade:$(e,h),onBid:m(h)}),t.jsx(W,{canTrain:0<n[c].bid&&n[c].bid<10,id:d[x]+" ðŸƒ",...n[x],blindTrade:$(e,x),onBid:m(x)})]})]})})},Se=({initials:e,onPenalty:s})=>t.jsx(V,{title:"Penalty",buttonVariant:"outlined",buttonColor:"error",children:t.jsxs(D,{container:!0,spacing:2,children:[t.jsx(D,{size:6,children:t.jsxs(X,{fullWidth:!0,variant:"contained",color:"error",onClick:s(0),children:["Team ",e[0]+e[2]]})}),t.jsx(D,{size:6,children:t.jsxs(X,{fullWidth:!0,variant:"contained",color:"error",onClick:s(1),children:["Team ",e[1]+e[3]]})})]})}),I=({initial:e,lastBid:s,made:d,setMade:a})=>{const n=()=>a(Math.max(d-1,G)),i=()=>a(Math.min(d+1,L));return t.jsxs(D,{size:6,children:[t.jsxs(F,{children:[e," Bid: ",s]}),t.jsxs("div",{children:["Made:",t.jsx(E,{onClick:n,disabled:d<=G,children:t.jsx(U,{"aria-label":"decrease"})}),d,t.jsx(E,{onClick:i,disabled:d>=L,children:t.jsx(ee,{"aria-label":"increase"})})]})]})},we=({initials:e,lastBid:s,onScoreSave:d})=>{const[a,n]=k.useState(3),[i,o]=k.useState(3),[c,h]=k.useState(3),[x,m]=k.useState(3),j=a+i+c+x,B=j===13?()=>{d([a,i,c,x]),n(3),o(3),h(3),m(3)}:void 0;return t.jsxs(V,{title:"+ Score",onSave:B,children:[t.jsxs(F,{color:j===13?"success":"warning",align:"center",marginBottom:1,children:[j!==13&&"âš ï¸"," Tricks: ",j]}),t.jsxs(D,{container:!0,spacing:2,children:[t.jsx(I,{initial:e[0],lastBid:s[0].bid,made:a,setMade:n}),t.jsx(I,{initial:e[1],lastBid:s[1].bid,made:i,setMade:o}),t.jsx(I,{initial:e[2],lastBid:s[2].bid,made:c,setMade:h}),t.jsx(I,{initial:e[3],lastBid:s[3].bid,made:x,setMade:m})]})]})},z={accessibility:{enabled:!0},chart:{zooming:{type:"xy"},height:340,backgroundColor:"transparent"},credits:{enabled:!1},legend:{enabled:!1},plotOptions:{column:{pointPadding:0},series:{marker:{enabled:!1},lineWidth:2}},title:{text:"Bags"},tooltip:{shared:!0},xAxis:{crosshair:!0},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0}}},ve=({initials:e,lifeBags:s,missedBids:d,color:a})=>{const n=Math.round(s[s.length-1]),i={...z,title:{...z.title,style:{color:a}},xAxis:{...z.xAxis,categories:e.split(""),lineColor:a,labels:{style:{color:a}}},yAxis:{...z.yAxis,lineColor:a,labels:{style:{color:a}}},series:[{name:"ðŸ’°",type:"column",data:s.slice(0,-1)},{name:"ðŸŽ°",type:"column",data:d},{name:"âœ…",type:"spline",data:[n,n,n,n],color:a,lineWidth:5}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ne,{highcharts:de,options:i})})},q=e=>e.reduce((s,d)=>d.train?s+"ðŸš‚":d.blind?s+"ðŸ¦®":d.bid===0?s+"ðŸš«":d.bid>=10?s+`,${d.bid},`:s+d.bid.toString(),""),J=(e,s,d,a)=>{let n=0,i=0,o="";if(e.blind&&s.blind)e.made===0&&s.made===0?n=80:(i=e.made+s.made,o="ðŸš«ðŸš«");else if(e.bid===0&&s.bid===0)e.blind||s.blind?e.made===0&&s.made===0?n=60:e.blind&&e.made===0||s.blind&&s.made===0?(n=30,i=e.made+s.made,o="ðŸš«"):e.made===0||s.made===0?(i=e.made+s.made,o="ðŸš«"):(n=-30,i=e.made+s.made,o="ðŸš«ðŸš«"):e.made===0&&s.made===0?n=40:e.made===0||s.made===0?(i=e.made+s.made,o="ðŸš«"):(n=-20,i=e.made+s.made,o="ðŸš«ðŸš«");else if(e.train||s.train)e.made+s.made>=10?(n=20,i=e.made+s.made-10):(n=-20,o="ðŸš‚");else{e.bid===0?e.made===0?n+=e.blind?20:10:(n-=10,i+=e.made,o="ðŸš«"):s.bid===0&&(s.made===0?n+=s.blind?20:10:(n-=10,i+=s.made,o="ðŸš«"));const c=e.bid+s.bid,h=(e.bid>0?e.made:0)+(s.bid>0?s.made:0);h>=c?(n+=c,i+=h-c):(n-=c,o+="ðŸŽ°")}for(;a+i>=10;)n-=9,i-=10,o+="ðŸ’°";return{score:d+n,bags:a+i,mod:o}},K=(e,s,d)=>{let a=s+3,n=(d||"")+"ðŸ˜ˆ",i=e;return a>=10&&(i-=9,a-=10,n+="ðŸ’°"),{score:i,bags:a,mod:n}},O=(e,s)=>e===s?"default":e>s?"success":"error",pe=(e,s,d,a,n,i)=>{const o=[...e],c=[...i],h=[...s],x=d,m=(d+1)%4,j=(d+2)%4,f=(d+3)%4,B=a[j].bid===0&&!a[j].blind,v=a[f].bid===0&&!a[f].blind,w=a[x].bid+a[j].bid>n[x]+n[j],M=a[m].bid+a[f].bid>n[m]+n[f];return a.forEach((S,l)=>{o[l][0]+=S.bid===0?1:0,o[l][1]+=S.blind?1:0,o[l][2]+=S.bid===0&&n[l]===0?1:0;const r=(l+2)%4,b=S.bid+a[r].bid-(n[l]+n[r]),u=S.bid-n[l];S.bid>2&&b>0&&u>0&&(c[l]+=Math.min(u,b)),!(l===x&&B||l===m&&v||((l===x||l===j)&&M||(l===m||l===f)&&w)||S.train||a[r].train)&&-b>0&&-u>0&&(h[l]+=Math.min(-u,-b))}),h[a.length]+=.25,{newNils:o,newMissedBids:c,newLifeBags:h}},N={accessibility:{enabled:!0},chart:{type:"column",height:340,backgroundColor:"transparent"},credits:{enabled:!1},legend:{padding:0},plotOptions:{column:{stacking:"normal",pointPadding:0}},title:{text:"Nils"},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0}}},Me=({color:e,initials:s,nils:d})=>{const a={...N,legend:{...N.legend,itemStyle:{color:e}},title:{...N.title,style:{color:e}},xAxis:{...N.xAxis,categories:s.split(""),lineColor:e,labels:{style:{color:e}}},yAxis:{...N.yAxis,lineColor:e,labels:{style:{color:e}}},series:[{name:"ðŸš«",data:d.map(n=>n[0]-n[1]),stack:"Nils",type:"column"},{name:"ðŸ¦®",data:d.map(n=>n[1]),stack:"Nils",type:"column"},{name:"ðŸ…",data:d.map(n=>n[2]),stack:"Wins",type:"column"}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ne,{highcharts:de,options:a})})},Ae=({initials:e})=>{const s=Y(ge),{total1:d,total2:a,nils:n,lifeBags:i,missedBids:o}=Y(ie),c=s.mode==="light"?"black":"white";return t.jsx(V,{title:"Stats",buttonVariant:"outlined",buttonColor:"success",children:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex-container",style:{paddingBottom:15},children:[t.jsx(F,{children:"Totals:"}),t.jsx(R,{avatar:t.jsx(_,{children:e[0]+e[2]}),color:O(d,a),label:d}),t.jsx(R,{avatar:t.jsx(_,{children:e[1]+e[3]}),color:O(a,d),label:a})]}),t.jsx(ve,{color:c,initials:e,lifeBags:i,missedBids:o}),t.jsx(Me,{color:c,initials:e,nils:n})]})})},Ce=({blindTrade:e,first:s,initials:d,lastBid:a,showPenalty:n,onBidSave:i,onPenalty:o,onScoreSave:c})=>t.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[t.jsx(Be,{blindTrade:e,first:s,initials:d,onBidSave:i}),n&&t.jsx(Se,{initials:d,onPenalty:o}),t.jsx(Ae,{initials:d}),t.jsx(we,{initials:d,lastBid:a,onScoreSave:c})]}),Q=(e,s)=>e===void 0||s===void 0||e===0?"":e>0?`${e>=100&&e>=s?"ðŸŽ‰ ":""}${e}`:`${e}0 + `,ke=({initials:e,data:s})=>t.jsxs(se,{"aria-label":"Bid Table",children:[t.jsx(te,{children:t.jsxs(H,{children:[t.jsx(y,{width:"10%",children:"ðŸ¥‡"}),t.jsxs(y,{children:["Bid",t.jsx("br",{}),"(",e[0]+e[1]+e[2]+e[3],")"]}),t.jsx(y,{children:e[0]+e[2]}),t.jsx(y,{children:e[1]+e[3]})]})}),t.jsx(ae,{children:s.map((d,a)=>t.jsxs(H,{children:[t.jsxs(y,{padding:a===s.length-1?"none":void 0,align:"center",children:[d.start,a===s.length-1&&(d.score1?"ðŸƒ":"ðŸ¥‡")]}),t.jsx(y,{children:d.bid}),t.jsxs(y,{children:[Q(d.score1,d.score2),d.bags1,d.mod1&&` (${d.mod1})`]}),t.jsxs(y,{children:[Q(d.score2,d.score1),d.bags2,d.mod2&&` (${d.mod2})`]})]},a))})]}),Te=()=>{const e=Y(ue),[s,d]=je(ie),{data:a,first:n,lastBid:i,lifeBags:o,missedBids:c,wins1:h,wins2:x,total1:m,total2:j,nils:f}=s,B=e.reduce((l,r,b)=>b<4?l+r.name[0]:l,"");return{data:a,first:n,initials:B,lastBid:i,lifeBags:o,wins1:h,wins2:x,addBid:l=>{const r=a.length-1;if(a[r]&&a[r]?.score1===void 0){const u=[...a];u[r].bid=q(l),d({...s,data:u,lastBid:l});return}const b=[...a];b.push({start:B[n],bid:q(l)}),d({...s,data:b,lastBid:l})},addPenalty:l=>()=>{let r=a.length-1;if(a[r]?.score1===void 0&&(r-=1),l===0){const{score1:b,bags1:u,mod1:p}=a[r]||{};if(b===void 0||u===void 0)return;const{score:C,bags:T,mod:P}=K(b,u,p),A=[...a];A[r]={...a[r],score1:C,bags1:T,mod1:P},d({...s,data:A})}else{const{score2:b,bags2:u,mod2:p}=a[r]||{};if(b===void 0||u===void 0)return;const{score:C,bags:T,mod:P}=K(b,u,p),A=[...a];A[r]={...a[r],score2:C,bags2:T,mod2:P},d({...s,data:A})}},addScore:l=>{const r=a.length-1;if(a[r]?.score1!==void 0)return;const b=[...a],{score1:u,bags1:p,score2:C,bags2:T}=a[r-1]||{},{score:P,bags:A,mod:oe}=J({...i[0],made:l[0]},{...i[2],made:l[2]},u||0,p||0),{score:le,bags:re,mod:ce}=J({...i[1],made:l[1]},{...i[3],made:l[3]},C||0,T||0);b[r]={...a[r],score1:P,bags1:A,mod1:oe,score2:le,bags2:re,mod2:ce};const{newNils:he,newMissedBids:me,newLifeBags:xe}=pe(f,o,n,i,l,c);d({...s,data:b,first:(n+1)%4,lastBid:[g,g,g,g],lifeBags:xe,missedBids:me,nils:he})},newGame:()=>{const{score1:l,bags1:r,score2:b,bags2:u}=a[a.length-1],p=l===b&&(r||0)>(u||0)||(l||0)>(b||0);d({...s,data:[],lastBid:[g,g,g,g],wins1:h+(p?1:0),wins2:x+(p?0:1),total1:m+(l||0)*10+(r||0),total2:j+(b||0)*10+(u||0)})}}},Pe=({initials:e,wins1:s,wins2:d})=>t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex-container",children:[t.jsx(F,{variant:"h2",component:"h1",children:"â™ ï¸ðŸ§®"}),t.jsx(R,{avatar:t.jsx(_,{children:e[0]+e[2]}),color:O(s,d),label:s}),t.jsx(R,{avatar:t.jsx(_,{children:e[1]+e[3]}),color:O(d,s),label:d}),t.jsx(fe,{})]})}),Ne=k.memo(()=>{const{data:e,initials:s,wins1:d,wins2:a,newGame:n,first:i,lastBid:o,addBid:c,addPenalty:h,addScore:x}=Te();let m=e.length-1;e[m]?.score1===void 0&&(m-=1);const j=e[m]?.score1||0,f=e[m]?.bags1||0,B=e[m]?.score2||0,v=e[m]?.bags2||0,w=j*10+f-(B*10+v),M=w>0?Math.floor(w/100):Math.ceil(w/100);return t.jsxs(t.Fragment,{children:[t.jsx(Pe,{initials:s,wins1:d,wins2:a}),j>=100||B>=100?t.jsx(X,{fullWidth:!0,color:"error",onClick:n,variant:"contained",sx:{marginTop:2},children:"Reset"}):t.jsx(Ce,{blindTrade:M,first:i,initials:s,lastBid:o,showPenalty:e[0]?.score1!==void 0,onBidSave:c,onPenalty:h,onScoreSave:x}),t.jsx(ke,{initials:s,data:e})]})});Ne.displayName="Spades";export{Ne as default};
//# sourceMappingURL=index-SvcrZRAW.js.map
