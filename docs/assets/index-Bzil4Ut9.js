import{O as X,j as a,r as M,M as q,A as J}from"./index-C1n9iYCe.js";import{p as K,P as L}from"./PlayerMenu-BobnSaud.js";import{I as _}from"./InfoPopup-38-JJfju.js";import{A as z}from"./Add-CJPN5njQ.js";import{R as E}from"./Remove-0cOCPnC5.js";import{b as y,c as b,T as W,a as F}from"./TableRow-BHomQO1M.js";import{I as P,S as G,T as I}from"./Header-Dec2tH_R.js";import{T as H}from"./TableHead-D6qbpttP.js";import{G as O}from"./Grid2-dI4kVeqR.js";import{B as Q}from"./Button-Bg-yzAWI.js";import"./Select-DrQwLcj7.js";import"./isMuiElement-twbsPRfP.js";import"./useSlotProps-BJ4cjFoi.js";import"./useId-C_tAptTg.js";import"./TextField-WAJ5TYiG.js";import"./DialogTitle-VcB05AEl.js";import"./useThemeProps-DdlmcrG0.js";const C=0,$=13,c={bid:3,blind:!1,train:!1},U={first:0,lastBid:[c,c,c,c],data:[]},Y=X("spadesAtom",U),T=({id:e,blindTrade:s,canTrain:d,bid:t,blind:n,train:r,onBid:i})=>{const o=()=>i(Math.max(t-1,C),!1,!1),m=()=>i(Math.min(t+1,$),!1,!1),l=(f,g)=>i(t,g,!1),h=(f,g)=>i(t,!1,g);return a.jsxs(y,{children:[a.jsx(b,{children:e}),a.jsxs(b,{align:"center",children:[a.jsx(P,{onClick:o,disabled:t<=C,children:a.jsx(E,{})}),t,a.jsx(P,{onClick:m,disabled:t>=$,children:a.jsx(z,{})})]}),a.jsxs(b,{align:"right",children:[a.jsx(G,{checked:n,inputProps:{"aria-label":`P${e} Blind Nil`},onChange:l,size:"small"}),s||n?s:""]}),a.jsx(b,{align:"right",children:d?a.jsx(G,{checked:r,inputProps:{"aria-label":`P${e} Trains`},onChange:h,size:"small"}):null})]})},A=(e,s)=>e<0&&(s===0||s===2)||e>0&&(s===1||s===3)?Math.min(Math.abs(e),3):0,Z=({blindTrade:e,first:s,initials:d,onBidSave:t})=>{const[n,r]=M.useState([c,c,c,c]),i=(s+0)%4,o=(s+1)%4,m=(s+2)%4,l=(s+3)%4,h=x=>(j,u,B)=>{let w={bid:j,blind:u,train:B};if(u)w={bid:0,blind:u,train:!1};else if(B){let S=10;switch(x){case i:S-=n[m].bid;break;case o:S-=n[l].bid;break;case m:S-=n[i].bid;break;case l:default:S-=n[o].bid}w={bid:S,blind:!1,train:B}}else w={bid:j,blind:!1,train:!1};const v=[...n];v[x]=w,r(v)},f=()=>{t(n),r([c,c,c,c])},g=n.reduce((x,j)=>x-j.bid,13);return a.jsx(_,{title:"+ Bid",onSave:f,children:a.jsxs(W,{"aria-label":"Bid Table",padding:"none",children:[a.jsx(H,{children:a.jsxs(y,{children:[a.jsx(b,{width:"20%",children:"P"}),a.jsxs(b,{width:"40%",align:"center",children:["Bid (",g," 💰)"]}),a.jsx(b,{width:"20%",align:"center",children:"🦮"}),a.jsx(b,{width:"20%",align:"center",children:"🚂"})]})}),a.jsxs(F,{children:[a.jsx(T,{id:d[i]+" 🥇",...n[i],onBid:h(i),blindTrade:A(e,i)}),a.jsx(T,{id:d[o],...n[o],onBid:h(o),blindTrade:A(e,o)}),a.jsx(T,{canTrain:0<n[i].bid&&n[i].bid<10,id:d[m],...n[m],blindTrade:A(e,m),onBid:h(m)}),a.jsx(T,{canTrain:0<n[o].bid&&n[o].bid<10,id:d[l]+" 🃏",...n[l],blindTrade:A(e,l),onBid:h(l)})]})]})})},k=({initial:e,lastBid:s,made:d,setMade:t})=>{const n=()=>t(Math.max(d-1,C)),r=()=>t(Math.min(d+1,$));return a.jsxs(O,{size:6,children:[a.jsxs(I,{children:[e," Bid: ",s]}),a.jsxs("div",{children:["Made:",a.jsx(P,{onClick:n,disabled:d<=C,children:a.jsx(E,{})}),d,a.jsx(P,{onClick:r,disabled:d>=$,children:a.jsx(z,{})})]})]})},p=({initials:e,lastBid:s,onScoreSave:d})=>{const[t,n]=M.useState(3),[r,i]=M.useState(3),[o,m]=M.useState(3),[l,h]=M.useState(3),f=t+r+o+l,x=f===13?()=>{d([t,r,o,l]),n(3),i(3),m(3),h(3)}:void 0;return a.jsxs(_,{title:"+ Score",onSave:x,children:[a.jsxs(I,{color:f===13?"success":"warning",align:"center",marginBottom:1,children:[f!==13&&"⚠️"," Tricks: ",f]}),a.jsxs(O,{container:!0,spacing:2,children:[a.jsx(k,{initial:e[0],lastBid:s[0].bid,made:t,setMade:n}),a.jsx(k,{initial:e[1],lastBid:s[1].bid,made:r,setMade:i}),a.jsx(k,{initial:e[2],lastBid:s[2].bid,made:o,setMade:m}),a.jsx(k,{initial:e[3],lastBid:s[3].bid,made:l,setMade:h})]})]})},ee=({blindTrade:e,first:s,initials:d,lastBid:t,onBidSave:n,onScoreSave:r})=>a.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[a.jsx(Z,{blindTrade:e,first:s,initials:d,onBidSave:n}),a.jsx(p,{initials:d,lastBid:t,onScoreSave:r})]}),N=(e,s)=>e===void 0||s===void 0||e===0?"":e>0?`${e>100&&e>s?"🎉 ":""}${e}`:`${e}0 + `,se=({initials:e,data:s})=>a.jsxs(W,{"aria-label":"Bid Table",children:[a.jsx(H,{children:a.jsxs(y,{children:[a.jsx(b,{width:"10%",children:"🥇"}),a.jsxs(b,{children:["Bid",a.jsx("br",{}),"(",e[0]+e[1]+e[2]+e[3],")"]}),a.jsx(b,{children:e[0]+e[2]}),a.jsx(b,{children:e[1]+e[3]})]})}),a.jsx(F,{children:s.map((d,t)=>a.jsxs(y,{children:[a.jsxs(b,{padding:t===s.length-1?"none":void 0,align:"center",children:[d.start,t===s.length-1&&(d.score1?"🃏":"🥇")]}),a.jsx(b,{children:d.bid}),a.jsxs(b,{children:[N(d.score1,d.score2),d.bags1,d.mod1&&` (${d.mod1})`]}),a.jsxs(b,{children:[N(d.score2,d.score1),d.bags2,d.mod2&&` (${d.mod2})`]})]},t))})]}),D=(e,s,d,t)=>{let n=0,r=0,i="";if(e.blind&&s.blind&&(e.made===0&&s.made===0?n=80:(r=e.made+s.made,i="🚫🚫")),e.bid===0&&s.bid===0&&((e.blind||s.blind)&&(e.made===0&&s.made===0?n=60:e.blind&&e.made===0||s.blind&&s.made===0?(n=30,r=e.made+s.made,i="🚫"):e.made===0||s.made===0?(r=e.made+s.made,i="🚫"):(n=-30,r=e.made+s.made,i="🚫🚫")),e.made===0&&s.made===0?n=40:e.made===0||s.made===0?(r=e.made+s.made,i="🚫"):(n=-20,r=e.made+s.made,i="🚫🚫")),e.train||s.train)e.made+s.made>=10?(n=20,r=e.made+s.made-10):(n=-20,i="🚂");else{e.bid===0?e.made===0?n+=e.blind?20:10:(n-=10,r+=e.made,i="🚫"):s.bid===0&&(s.made===0?n+=s.blind?20:10:(n-=10,r+=s.made,i="🚫"));const o=e.bid+s.bid,m=(e.bid>0?e.made:0)+(s.bid>0?s.made:0);m>=o?(n+=o,r+=m-o):(n-=o,i+="🎰")}for(;t+r>=10;)n-=9,r-=10,i+="💰";return{score:d+n,bags:t+r,mod:i}},ae=()=>{const e=q(K),[{first:s,lastBid:d,data:t},n]=J(Y),r=[e[0].name[0],e[1].name[0],e[2].name[0],e[3].name[0]];return{first:s,lastBid:d,data:t,initials:r,addBid:l=>{var g;if(t[t.length-1]&&((g=t[t.length-1])==null?void 0:g.score1)===void 0)return;const h=[...t],f={start:r[s],bid:l.reduce((x,j)=>j.train?x+"🚂":j.blind?x+"🦮":j.bid===0?x+"🚫":j.bid>=10?x+`,${j.bid},`:x+j.bid.toString(),"")};h.push(f),n({first:s,lastBid:l,data:h})},addScore:l=>{var R;if(((R=t[t.length-1])==null?void 0:R.score1)!==void 0)return;const h=[...t],{score1:f,bags1:g,score2:x,bags2:j}=t[t.length-2]||{},{score:u,bags:B,mod:w}=D({...d[0],made:l[0]},{...d[2],made:l[2]},f||0,g||0),{score:v,bags:S,mod:V}=D({...d[1],made:l[1]},{...d[3],made:l[3]},x||0,j||0);h[t.length-1]={...t[t.length-1],score1:u,bags1:B,mod1:w,score2:v,bags2:S,mod2:V},n({first:(s+1)%4,lastBid:[c,c,c,c],data:h})},newGame:()=>n({first:s,lastBid:[c,c,c,c],data:[]})}},de=M.memo(()=>{var h,f,g,x,j,u,B;const{first:e,lastBid:s,data:d,initials:t,addBid:n,addScore:r,newGame:i}=ae();let o=d.length-1;((h=d[o])==null?void 0:h.score1)===void 0&&(o-=1);const m=(((f=d[o])==null?void 0:f.score1)||0)*10+(((g=d[o])==null?void 0:g.bags1)||0)-((((x=d[o])==null?void 0:x.score2)||0)*10+(((j=d[o])==null?void 0:j.bags2)||0)),l=m>0?Math.floor(m/100):Math.ceil(m/100);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-container",children:[a.jsx(I,{variant:"h2",component:"h1",children:"♠️ Scores"}),a.jsx(L,{})]}),(((u=d[d.length-1])==null?void 0:u.score1)||0)>=100||(((B=d[d.length-1])==null?void 0:B.score2)||0)>=100?a.jsx(Q,{fullWidth:!0,color:"error",onClick:i,variant:"contained",sx:{marginTop:2},children:"Reset"}):a.jsx(ee,{blindTrade:l,first:e,initials:t,lastBid:s,onBidSave:n,onScoreSave:r}),a.jsx(se,{initials:t,data:d})]})});de.displayName="Spades";export{de as default};
//# sourceMappingURL=index-Bzil4Ut9.js.map
