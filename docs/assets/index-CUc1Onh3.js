import{O as be,j as t,r as T,M as X,E as ge,A as je}from"./index-YjvXMwAe.js";import{I as F}from"./InfoPopup-BLttukRi.js";import{A as Z}from"./Add-B0dPzrVZ.js";import{R as ee}from"./Remove-CHCSgxYp.js";import{b as E,c as y,T as se,a as te}from"./TableRow-BjldIzFc.js";import{I as H,S as J,T as V}from"./Header-CVgMWi9H.js";import{T as ae}from"./TableHead-BFmBsNLp.js";import{G as D}from"./Grid-C0bOByTb.js";import{B as q}from"./Button-DJfYjV4H.js";import{H as ne,a as de}from"./highcharts-react.min-DHw6_byv.js";import{C as R}from"./Chip-C8mxPaU7.js";import{A as G}from"./Avatar-Blbzyq0u.js";import{p as fe,P as ue}from"./PlayerMenu-CVuAdLXc.js";import"./DialogTitle-CJi0EiP3.js";import"./useThemeProps-zizEJNGY.js";import"./isMuiElement-P1FLybK7.js";import"./Select-D7AeiOOh.js";import"./useSlotProps-Cz1dbOeb.js";import"./TextField-CxXZBIJD.js";const O=0,L=13,g={bid:3,blind:!1,train:!1},ye={data:[],first:0,lastBid:[g,g,g,g],lifeBags:[0,0,0,0,0],missedBids:[0,0,0,0],wins1:0,wins2:0,total1:0,total2:0,nils:[[0,0,0],[0,0,0],[0,0,0],[0,0,0]]},oe=be("spadesAtom",ye),W=({id:e,blindTrade:s,canTrain:d,bid:a,blind:n,train:o,onBid:i})=>{const c=()=>i(Math.max(a-1,O),!1,!1),m=()=>i(Math.min(a+1,L),!1,!1),x=(j,u)=>i(a,u,!1),h=(j,u)=>i(a,!1,u);return t.jsxs(E,{children:[t.jsx(y,{children:e}),t.jsxs(y,{align:"center",children:[t.jsx(H,{onClick:c,disabled:a<=O,children:t.jsx(ee,{})}),a,t.jsx(H,{onClick:m,disabled:a>=L,children:t.jsx(Z,{})})]}),t.jsxs(y,{align:"right",children:[t.jsx(J,{checked:n,slotProps:{input:{"aria-label":`P${e} Blind Nil`}},onChange:x,size:"small"}),s||n?s:""]}),t.jsx(y,{align:"right",children:d?t.jsx(J,{checked:o,slotProps:{input:{"aria-label":`P${e} Trains`}},onChange:h,size:"small"}):null})]})},$=(e,s)=>e<0&&(s===0||s===2)||e>0&&(s===1||s===3)?Math.min(Math.abs(e),3):0,Be=({blindTrade:e,first:s,initials:d,onBidSave:a})=>{const[n,o]=T.useState([g,g,g,g]),i=(s+0)%4,c=(s+1)%4,m=(s+2)%4,x=(s+3)%4,h=B=>(w,S,A)=>{let p={bid:w,blind:S,train:A};if(S)p={bid:0,blind:S,train:!1};else if(A){let l=10;switch(B){case i:l-=n[m].bid;break;case c:l-=n[x].bid;break;case m:l-=n[i].bid;break;case x:default:l-=n[c].bid}p={bid:l,blind:!1,train:A}}else p={bid:w,blind:!1,train:!1};const r=[...n];r[B]=p,o(r)},j=()=>{a(n),o([g,g,g,g])},u=n.reduce((B,w)=>B-w.bid,13);return t.jsx(F,{title:"+ Bid",onSave:j,children:t.jsxs(se,{"aria-label":"Bid Table",padding:"none",children:[t.jsx(ae,{children:t.jsxs(E,{children:[t.jsx(y,{width:"20%",children:"P"}),t.jsxs(y,{width:"40%",align:"center",children:["Bid (",u," ðŸ’°)"]}),t.jsx(y,{width:"20%",align:"center",children:"ðŸ¦®"}),t.jsx(y,{width:"20%",align:"center",children:"ðŸš‚"})]})}),t.jsxs(te,{children:[t.jsx(W,{id:d[i]+" ðŸ¥‡",...n[i],onBid:h(i),blindTrade:$(e,i)}),t.jsx(W,{id:d[c],...n[c],onBid:h(c),blindTrade:$(e,c)}),t.jsx(W,{canTrain:0<n[i].bid&&n[i].bid<10,id:d[m],...n[m],blindTrade:$(e,m),onBid:h(m)}),t.jsx(W,{canTrain:0<n[c].bid&&n[c].bid<10,id:d[x]+" ðŸƒ",...n[x],blindTrade:$(e,x),onBid:h(x)})]})]})})},pe=({initials:e,onPenalty:s})=>t.jsx(F,{title:"Penalty",buttonVariant:"outlined",buttonColor:"error",children:t.jsxs(D,{container:!0,spacing:2,children:[t.jsx(D,{size:6,children:t.jsxs(q,{fullWidth:!0,variant:"contained",color:"error",onClick:s(0),children:["Team ",e[0]+e[2]]})}),t.jsx(D,{size:6,children:t.jsxs(q,{fullWidth:!0,variant:"contained",color:"error",onClick:s(1),children:["Team ",e[1]+e[3]]})})]})}),I=({initial:e,lastBid:s,made:d,setMade:a})=>{const n=()=>a(Math.max(d-1,O)),o=()=>a(Math.min(d+1,L));return t.jsxs(D,{size:6,children:[t.jsxs(V,{children:[e," Bid: ",s]}),t.jsxs("div",{children:["Made:",t.jsx(H,{onClick:n,disabled:d<=O,children:t.jsx(ee,{"aria-label":"decrease"})}),d,t.jsx(H,{onClick:o,disabled:d>=L,children:t.jsx(Z,{"aria-label":"increase"})})]})]})},Se=({initials:e,lastBid:s,onScoreSave:d})=>{const[a,n]=T.useState(3),[o,i]=T.useState(3),[c,m]=T.useState(3),[x,h]=T.useState(3),j=a+o+c+x,B=j===13?()=>{d([a,o,c,x]),n(3),i(3),m(3),h(3)}:void 0;return t.jsxs(F,{title:"+ Score",onSave:B,children:[t.jsxs(V,{color:j===13?"success":"warning",align:"center",marginBottom:1,children:[j!==13&&"âš ï¸"," Tricks: ",j]}),t.jsxs(D,{container:!0,spacing:2,children:[t.jsx(I,{initial:e[0],lastBid:s[0].bid,made:a,setMade:n}),t.jsx(I,{initial:e[1],lastBid:s[1].bid,made:o,setMade:i}),t.jsx(I,{initial:e[2],lastBid:s[2].bid,made:c,setMade:m}),t.jsx(I,{initial:e[3],lastBid:s[3].bid,made:x,setMade:h})]})]})},z={accessibility:{enabled:!0},chart:{zooming:{type:"xy"},height:340,backgroundColor:"transparent"},credits:{enabled:!1},legend:{enabled:!1},plotOptions:{column:{pointPadding:0},series:{marker:{enabled:!1},lineWidth:2}},title:{text:"Bags"},tooltip:{shared:!0},xAxis:{crosshair:!0},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0}}},we=({initials:e,lifeBags:s,missedBids:d,color:a})=>{const n=Math.round(s[s.length-1]),o={...z,title:{...z.title,style:{color:a}},xAxis:{...z.xAxis,categories:e.split(""),lineColor:a,labels:{style:{color:a}}},yAxis:{...z.yAxis,lineColor:a,labels:{style:{color:a}}},series:[{name:"ðŸ’°",type:"column",data:s.slice(0,-1)},{name:"ðŸŽ°",type:"column",data:d},{name:"âœ…",type:"spline",data:[n,n,n,n],color:a,lineWidth:5}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ne,{highcharts:de,options:o})})},K=e=>e.reduce((s,d)=>d.train?s+"ðŸš‚":d.blind?s+"ðŸ¦®":d.bid===0?s+"ðŸš«":d.bid>=10?s+`,${d.bid},`:s+d.bid.toString(),""),Q=(e,s,d,a)=>{let n=0,o=0,i="";if(e.blind&&s.blind)e.made===0&&s.made===0?n=80:(o=e.made+s.made,i="ðŸš«ðŸš«");else if(e.bid===0&&s.bid===0)e.blind||s.blind?e.made===0&&s.made===0?n=60:e.blind&&e.made===0||s.blind&&s.made===0?(n=30,o=e.made+s.made,i="ðŸš«"):e.made===0||s.made===0?(o=e.made+s.made,i="ðŸš«"):(n=-30,o=e.made+s.made,i="ðŸš«ðŸš«"):e.made===0&&s.made===0?n=40:e.made===0||s.made===0?(o=e.made+s.made,i="ðŸš«"):(n=-20,o=e.made+s.made,i="ðŸš«ðŸš«");else if(e.train||s.train)e.made+s.made>=10?(n=20,o=e.made+s.made-10):(n=-20,i="ðŸš‚");else{e.bid===0?e.made===0?n+=e.blind?20:10:(n-=10,o+=e.made,i="ðŸš«"):s.bid===0&&(s.made===0?n+=s.blind?20:10:(n-=10,o+=s.made,i="ðŸš«"));const c=e.bid+s.bid,m=(e.bid>0?e.made:0)+(s.bid>0?s.made:0);m>=c?(n+=c,o+=m-c):(n-=c,i+="ðŸŽ°")}for(;a+o>=10;)n-=9,o-=10,i+="ðŸ’°";return{score:d+n,bags:a+o,mod:i}},U=(e,s,d)=>{let a=s+3,n=(d||"")+"ðŸ˜ˆ",o=e;return a>=10&&(o-=9,a-=10,n+="ðŸ’°"),{score:o,bags:a,mod:n}},_=(e,s)=>e===s?"default":e>s?"success":"error",ve=(e,s,d,a,n,o)=>{const i=[...e],c=[...o],m=[...s],x=d,h=(d+1)%4,j=(d+2)%4,u=(d+3)%4,B=a[j].bid===0&&!a[j].blind,w=a[u].bid===0&&!a[u].blind,S=a[x].bid+a[j].bid>n[x]+n[j],A=a[h].bid+a[u].bid>n[h]+n[u];return a.forEach((p,r)=>{i[r][0]+=p.bid===0?1:0,i[r][1]+=p.blind?1:0,i[r][2]+=p.bid===0&&n[r]===0?1:0;const l=(r+2)%4,b=p.bid+a[l].bid-(n[r]+n[l]),f=p.bid-n[r];p.bid>2&&b>0&&f>0&&(c[r]+=Math.min(f,b)),!(r===x&&B||r===h&&w||((r===x||r===j)&&A||(r===h||r===u)&&S)||p.train||a[l].train)&&-b>0&&-f>0&&(m[r]+=Math.min(-f,-b))}),m[a.length]+=.25,{newNils:i,newMissedBids:c,newLifeBags:m}},N={accessibility:{enabled:!0},chart:{type:"column",height:340,backgroundColor:"transparent"},credits:{enabled:!1},legend:{padding:0},plotOptions:{column:{stacking:"normal",pointPadding:0}},title:{text:"Nils"},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0}}},Ae=({color:e,initials:s,nils:d})=>{const a={...N,legend:{...N.legend,itemStyle:{color:e}},title:{...N.title,style:{color:e}},xAxis:{...N.xAxis,categories:s.split(""),lineColor:e,labels:{style:{color:e}}},yAxis:{...N.yAxis,lineColor:e,labels:{style:{color:e}}},series:[{name:"ðŸš«",data:d.map(n=>n[0]-n[1]),stack:"Nils",type:"column"},{name:"ðŸ¦®",data:d.map(n=>n[1]),stack:"Nils",type:"column"},{name:"ðŸ…",data:d.map(n=>n[2]),stack:"Wins",type:"column"}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ne,{highcharts:de,options:a})})},Me=({initials:e})=>{const s=X(ge),{total1:d,total2:a,nils:n,lifeBags:o,missedBids:i}=X(oe),c=s.mode==="light"?"black":"white";return t.jsx(F,{title:"Stats",buttonVariant:"outlined",buttonColor:"success",children:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex-container",style:{paddingBottom:15},children:[t.jsx(V,{children:"Totals:"}),t.jsx(R,{avatar:t.jsx(G,{children:e[0]+e[2]}),color:_(d,a),label:d}),t.jsx(R,{avatar:t.jsx(G,{children:e[1]+e[3]}),color:_(a,d),label:a})]}),t.jsx(we,{color:c,initials:e,lifeBags:o,missedBids:i}),t.jsx(Ae,{color:c,initials:e,nils:n})]})})},Ce=({blindTrade:e,first:s,initials:d,lastBid:a,showPenalty:n,onBidSave:o,onPenalty:i,onScoreSave:c})=>t.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[t.jsx(Be,{blindTrade:e,first:s,initials:d,onBidSave:o}),n&&t.jsx(pe,{initials:d,onPenalty:i}),t.jsx(Me,{initials:d}),t.jsx(Se,{initials:d,lastBid:a,onScoreSave:c})]}),Y=(e,s)=>e===void 0||s===void 0||e===0?"":e>0?`${e>=100&&e>=s?"ðŸŽ‰ ":""}${e}`:`${e}0 + `,Te=({initials:e,data:s})=>t.jsxs(se,{"aria-label":"Bid Table",children:[t.jsx(ae,{children:t.jsxs(E,{children:[t.jsx(y,{width:"10%",children:"ðŸ¥‡"}),t.jsxs(y,{children:["Bid",t.jsx("br",{}),"(",e[0]+e[1]+e[2]+e[3],")"]}),t.jsx(y,{children:e[0]+e[2]}),t.jsx(y,{children:e[1]+e[3]})]})}),t.jsx(te,{children:s.map((d,a)=>t.jsxs(E,{children:[t.jsxs(y,{padding:a===s.length-1?"none":void 0,align:"center",children:[d.start,a===s.length-1&&(d.score1?"ðŸƒ":"ðŸ¥‡")]}),t.jsx(y,{children:d.bid}),t.jsxs(y,{children:[Y(d.score1,d.score2),d.bags1,d.mod1&&` (${d.mod1})`]}),t.jsxs(y,{children:[Y(d.score2,d.score1),d.bags2,d.mod2&&` (${d.mod2})`]})]},a))})]}),ke=()=>{const e=X(fe),[s,d]=je(oe),{data:a,first:n,lastBid:o,lifeBags:i,missedBids:c,wins1:m,wins2:x,total1:h,total2:j,nils:u}=s,B=e.reduce((r,l,b)=>b<4?r+l.name[0]:r,"");return{data:a,first:n,initials:B,lastBid:o,lifeBags:i,wins1:m,wins2:x,addBid:r=>{const l=a.length-1;if(a[l]&&a[l]?.score1===void 0){const f=[...a];f[l].bid=K(r),d({...s,data:f,lastBid:r});return}const b=[...a];b.push({start:B[n],bid:K(r)}),d({...s,data:b,lastBid:r})},addPenalty:r=>()=>{let l=a.length-1;if(a[l]?.score1===void 0&&(l-=1),r===0){const{score1:b,bags1:f,mod1:v}=a[l]||{};if(b===void 0||f===void 0)return;const{score:C,bags:k,mod:P}=U(b,f,v),M=[...a];M[l]={...a[l],score1:C,bags1:k,mod1:P},d({...s,data:M})}else{const{score2:b,bags2:f,mod2:v}=a[l]||{};if(b===void 0||f===void 0)return;const{score:C,bags:k,mod:P}=U(b,f,v),M=[...a];M[l]={...a[l],score2:C,bags2:k,mod2:P},d({...s,data:M})}},addScore:r=>{const l=a.length-1;if(a[l]?.score1!==void 0)return;const b=[...a],{score1:f,bags1:v,score2:C,bags2:k}=a[l-1]||{},{score:P,bags:M,mod:ie}=Q({...o[0],made:r[0]},{...o[2],made:r[2]},f||0,v||0),{score:re,bags:le,mod:ce}=Q({...o[1],made:r[1]},{...o[3],made:r[3]},C||0,k||0);b[l]={...a[l],score1:P,bags1:M,mod1:ie,score2:re,bags2:le,mod2:ce};const{newNils:me,newMissedBids:he,newLifeBags:xe}=ve(u,i,n,o,r,c);d({...s,data:b,first:(n+1)%4,lastBid:[g,g,g,g],lifeBags:xe,missedBids:he,nils:me})},newGame:()=>{const{score1:r,bags1:l,score2:b,bags2:f}=a[a.length-1],v=r===b&&(l||0)>(f||0)||(r||0)>(b||0);d({...s,data:[],lastBid:[g,g,g,g],wins1:m+(v?1:0),wins2:x+(v?0:1),total1:h+(r||0)*10+(l||0),total2:j+(b||0)*10+(f||0)})}}},Pe=({initials:e,wins1:s,wins2:d})=>t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex-container",children:[t.jsx(V,{variant:"h2",component:"h1",children:"â™ ï¸ðŸ§®"}),t.jsx(R,{avatar:t.jsx(G,{children:e[0]+e[2]}),color:_(s,d),label:s}),t.jsx(R,{avatar:t.jsx(G,{children:e[1]+e[3]}),color:_(d,s),label:d}),t.jsx(ue,{})]})}),Ne=T.memo(()=>{const{data:e,initials:s,wins1:d,wins2:a,newGame:n,first:o,lastBid:i,addBid:c,addPenalty:m,addScore:x}=ke();let h=e.length-1;e[h]?.score1===void 0&&(h-=1);const j=e[h]?.score1||0,u=e[h]?.bags1||0,B=e[h]?.score2||0,w=e[h]?.bags2||0,S=j*10+u-(B*10+w),A=S>0?Math.floor(S/100):Math.ceil(S/100);return t.jsxs(t.Fragment,{children:[t.jsx(Pe,{initials:s,wins1:d,wins2:a}),j>=100||B>=100?t.jsx(q,{fullWidth:!0,color:"error",onClick:n,variant:"contained",sx:{marginTop:2},children:"Reset"}):t.jsx(Ce,{blindTrade:A,first:o,initials:s,lastBid:i,showPenalty:e[0]?.score1!==void 0,onBidSave:c,onPenalty:m,onScoreSave:x}),t.jsx(Te,{initials:s,data:e})]})});Ne.displayName="Spades";export{Ne as default};
//# sourceMappingURL=index-CUc1Onh3.js.map
