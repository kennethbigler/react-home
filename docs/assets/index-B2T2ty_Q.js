import{Q as ge,j as t,r as C,P as O,G as je,D as fe}from"./index-CosVh3Sb.js";import{I as F}from"./InfoPopup-DmGlk6Gj.js";import{A as Z}from"./Add-DTV1phkV.js";import{R as ee}from"./Remove-BbAxGWAu.js";import{b as z,c as y,T as se,a as te}from"./TableRow-BYLEwVVh.js";import{I as G,S as q,T as V}from"./Header-COtRrNxz.js";import{T as ae}from"./TableHead-BmIYYy8E.js";import{G as D}from"./Grid-CdVfZhoe.js";import{B as Q}from"./Button-DtcxNQ2w.js";import{H as ne,a as de}from"./highcharts-react.min-WM1-p3Ks.js";import{C as H}from"./Chip-1TQxSa9Q.js";import{A as R}from"./Avatar-Br2ohuIR.js";import{p as ue,P as Be}from"./PlayerMenu-CVZSryQE.js";import"./DialogTitle-DlAZqq6a.js";import"./useThemeProps-ew81M0K2.js";import"./isMuiElement-Bm39wPZq.js";import"./Select-BEctpKkV.js";import"./useSlotProps-Y-uIL6QN.js";import"./TextField-BvpVucpJ.js";const E=0,L=13,j={bid:3,blind:!1,train:!1},Se={data:[],first:0,lastBid:[j,j,j,j],lifeBags:[0,0,0,0,0],missedBids:[0,0,0,0],wins1:0,wins2:0,total1:0,total2:0,nils:[[0,0,0],[0,0,0],[0,0,0],[0,0,0]]},oe=ge("spadesAtom",Se),W=({id:e,blindTrade:s,canTrain:d,bid:a,blind:n,train:o,onBid:r})=>{const c=()=>r(Math.max(a-1,E),!1,!1),m=()=>r(Math.min(a+1,L),!1,!1),x=(f,B)=>r(a,B,!1),h=(f,B)=>r(a,!1,B);return t.jsxs(z,{children:[t.jsx(y,{children:e}),t.jsxs(y,{align:"center",children:[t.jsx(G,{onClick:c,disabled:a<=E,children:t.jsx(ee,{})}),a,t.jsx(G,{onClick:m,disabled:a>=L,children:t.jsx(Z,{})})]}),t.jsxs(y,{align:"right",children:[t.jsx(q,{checked:n,slotProps:{input:{"aria-label":`P${e} Blind Nil`}},onChange:x,size:"small"}),s||n?s:""]}),t.jsx(y,{align:"right",children:d?t.jsx(q,{checked:o,slotProps:{input:{"aria-label":`P${e} Trains`}},onChange:h,size:"small"}):null})]})},$=(e,s)=>e<0&&(s===0||s===2)||e>0&&(s===1||s===3)?Math.min(Math.abs(e),3):0,ye=({blindTrade:e,first:s,initials:d,onBidSave:a})=>{const[n,o]=C.useState([j,j,j,j]),r=(s+0)%4,c=(s+1)%4,m=(s+2)%4,x=(s+3)%4,h=p=>(v,w,M)=>{let S={bid:v,blind:w,train:M};if(w)S={bid:0,blind:w,train:!1};else if(M){let l=10;switch(p){case r:l-=n[m].bid;break;case c:l-=n[x].bid;break;case m:l-=n[r].bid;break;case x:default:l-=n[c].bid}S={bid:l,blind:!1,train:M}}else S={bid:v,blind:!1,train:!1};const i=[...n];i[p]=S,o(i)},f=()=>{a(n),o([j,j,j,j])},B=n.reduce((p,v)=>p-v.bid,13);return t.jsx(F,{title:"+ Bid",onSave:f,children:t.jsxs(se,{"aria-label":"Bid Table",padding:"none",children:[t.jsx(ae,{children:t.jsxs(z,{children:[t.jsx(y,{width:"20%",children:"P"}),t.jsxs(y,{width:"40%",align:"center",children:["Bid (",B," 💰)"]}),t.jsx(y,{width:"20%",align:"center",children:"🦮"}),t.jsx(y,{width:"20%",align:"center",children:"🚂"})]})}),t.jsxs(te,{children:[t.jsx(W,{id:d[r]+" 🥇",...n[r],onBid:h(r),blindTrade:$(e,r)}),t.jsx(W,{id:d[c],...n[c],onBid:h(c),blindTrade:$(e,c)}),t.jsx(W,{canTrain:0<n[r].bid&&n[r].bid<10,id:d[m],...n[m],blindTrade:$(e,m),onBid:h(m)}),t.jsx(W,{canTrain:0<n[c].bid&&n[c].bid<10,id:d[x]+" 🃏",...n[x],blindTrade:$(e,x),onBid:h(x)})]})]})})},pe=({initials:e,onPenalty:s})=>t.jsx(F,{title:"Penalty",buttonVariant:"outlined",buttonColor:"error",children:t.jsxs(D,{container:!0,spacing:2,children:[t.jsx(D,{size:6,children:t.jsxs(Q,{fullWidth:!0,variant:"contained",color:"error",onClick:s(0),children:["Team ",e[0]+e[2]]})}),t.jsx(D,{size:6,children:t.jsxs(Q,{fullWidth:!0,variant:"contained",color:"error",onClick:s(1),children:["Team ",e[1]+e[3]]})})]})}),I=({initial:e,lastBid:s,made:d,setMade:a})=>{const n=()=>a(Math.max(d-1,E)),o=()=>a(Math.min(d+1,L));return t.jsxs(D,{size:6,children:[t.jsxs(V,{children:[e," Bid: ",s]}),t.jsxs("div",{children:["Made:",t.jsx(G,{onClick:n,disabled:d<=E,children:t.jsx(ee,{"aria-label":"decrease"})}),d,t.jsx(G,{onClick:o,disabled:d>=L,children:t.jsx(Z,{"aria-label":"increase"})})]})]})},we=({initials:e,lastBid:s,onScoreSave:d})=>{const[a,n]=C.useState(3),[o,r]=C.useState(3),[c,m]=C.useState(3),[x,h]=C.useState(3),f=a+o+c+x,p=f===13?()=>{d([a,o,c,x]),n(3),r(3),m(3),h(3)}:void 0;return t.jsxs(F,{title:"+ Score",onSave:p,children:[t.jsxs(V,{color:f===13?"success":"warning",align:"center",marginBottom:1,children:[f!==13&&"⚠️"," Tricks: ",f]}),t.jsxs(D,{container:!0,spacing:2,children:[t.jsx(I,{initial:e[0],lastBid:s[0].bid,made:a,setMade:n}),t.jsx(I,{initial:e[1],lastBid:s[1].bid,made:o,setMade:r}),t.jsx(I,{initial:e[2],lastBid:s[2].bid,made:c,setMade:m}),t.jsx(I,{initial:e[3],lastBid:s[3].bid,made:x,setMade:h})]})]})},re=C.memo(({initials:e,lifeBags:s,missedBids:d,color:a})=>{const n=Math.round(s[s.length-1]),o={accessibility:{enabled:!0},chart:{zooming:{type:"xy"},height:340,backgroundColor:null},credits:{enabled:!1},legend:{enabled:!1},plotOptions:{column:{pointPadding:0},series:{marker:{enabled:!1},lineWidth:2}},title:{text:"Bags",style:{color:a}},tooltip:{shared:!0},xAxis:{crosshair:!0,categories:e.split(""),lineColor:a,labels:{style:{color:a}}},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0},lineColor:a,labels:{style:{color:a}}},series:[{name:"💰",type:"column",data:s.slice(0,-1)},{name:"🎰",type:"column",data:d},{name:"✅",type:"spline",data:[n,n,n,n],color:a,lineWidth:5}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ne,{highcharts:de,options:o})})});re.displayName="StatsBagsChart";const J=e=>e.reduce((s,d)=>d.train?s+"🚂":d.blind?s+"🦮":d.bid===0?s+"🚫":d.bid>=10?s+`,${d.bid},`:s+d.bid.toString(),""),K=(e,s,d,a)=>{let n=0,o=0,r="";if(e.blind&&s.blind)e.made===0&&s.made===0?n=80:(o=e.made+s.made,r="🚫🚫");else if(e.bid===0&&s.bid===0)e.blind||s.blind?e.made===0&&s.made===0?n=60:e.blind&&e.made===0||s.blind&&s.made===0?(n=30,o=e.made+s.made,r="🚫"):e.made===0||s.made===0?(o=e.made+s.made,r="🚫"):(n=-30,o=e.made+s.made,r="🚫🚫"):e.made===0&&s.made===0?n=40:e.made===0||s.made===0?(o=e.made+s.made,r="🚫"):(n=-20,o=e.made+s.made,r="🚫🚫");else if(e.train||s.train)e.made+s.made>=10?(n=20,o=e.made+s.made-10):(n=-20,r="🚂");else{e.bid===0?e.made===0?n+=e.blind?20:10:(n-=10,o+=e.made,r="🚫"):s.bid===0&&(s.made===0?n+=s.blind?20:10:(n-=10,o+=s.made,r="🚫"));const c=e.bid+s.bid,m=(e.bid>0?e.made:0)+(s.bid>0?s.made:0);m>=c?(n+=c,o+=m-c):(n-=c,r+="🎰")}for(;a+o>=10;)n-=9,o-=10,r+="💰";return{score:d+n,bags:a+o,mod:r}},U=(e,s,d)=>{let a=s+3,n=(d||"")+"😈",o=e;return a>=10&&(o-=9,a-=10,n+="💰"),{score:o,bags:a,mod:n}},_=(e,s)=>e===s?"default":e>s?"success":"error",ve=(e,s,d,a,n,o)=>{const r=[...e],c=[...o],m=[...s],x=d,h=(d+1)%4,f=(d+2)%4,B=(d+3)%4,p=a[f].bid===0&&!a[f].blind,v=a[B].bid===0&&!a[B].blind,w=a[x].bid+a[f].bid>n[x]+n[f],M=a[h].bid+a[B].bid>n[h]+n[B];return a.forEach((S,i)=>{r[i][0]+=S.bid===0?1:0,r[i][1]+=S.blind?1:0,r[i][2]+=S.bid===0&&n[i]===0?1:0;const l=(i+2)%4,b=S.bid+a[l].bid-(n[i]+n[l]),g=S.bid-n[i];S.bid>2&&b>0&&g>0&&(c[i]+=Math.min(g,b)),!(i===x&&p||i===h&&v||((i===x||i===f)&&M||(i===h||i===B)&&w)||S.train||a[l].train)&&-b>0&&-g>0&&(m[i]+=Math.min(-g,-b))}),m[a.length]+=.25,{newNils:r,newMissedBids:c,newLifeBags:m}},ie=C.memo(({color:e,initials:s,nils:d})=>{const a={accessibility:{enabled:!0},chart:{type:"column",height:340,backgroundColor:null},credits:{enabled:!1},legend:{padding:0,itemStyle:{color:e}},plotOptions:{column:{stacking:"normal",pointPadding:0}},title:{text:"Nils",style:{color:e}},xAxis:{categories:s.split(""),lineColor:e,labels:{style:{color:e}}},yAxis:{floor:0,gridLineDashStyle:"Dot",allowDecimals:!1,title:{text:void 0},lineColor:e,labels:{style:{color:e}}},series:[{name:"🚫",data:d.map(n=>n[0]-n[1]),stack:"Nils"},{name:"🦮",data:d.map(n=>n[1]),stack:"Nils"},{name:"🏅",data:d.map(n=>n[2]),stack:"Wins"}]};return t.jsx("figure",{style:{margin:0,width:"100%"},children:t.jsx(ne,{highcharts:de,options:a})})});ie.displayName="StatsNilChart";const Me=({initials:e})=>{const s=O(je),{total1:d,total2:a,nils:n,lifeBags:o,missedBids:r}=O(oe),c=s.mode==="light"?"black":"white";return t.jsx(F,{title:"Stats",buttonVariant:"outlined",buttonColor:"success",children:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex-container",style:{paddingBottom:15},children:[t.jsx(V,{children:"Totals:"}),t.jsx(H,{avatar:t.jsx(R,{children:e[0]+e[2]}),color:_(d,a),label:d}),t.jsx(H,{avatar:t.jsx(R,{children:e[1]+e[3]}),color:_(a,d),label:a})]}),t.jsx(re,{color:c,initials:e,lifeBags:o,missedBids:r}),t.jsx(ie,{color:c,initials:e,nils:n})]})})},Ce=({blindTrade:e,first:s,initials:d,lastBid:a,showPenalty:n,onBidSave:o,onPenalty:r,onScoreSave:c})=>t.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[t.jsx(ye,{blindTrade:e,first:s,initials:d,onBidSave:o}),n&&t.jsx(pe,{initials:d,onPenalty:r}),t.jsx(Me,{initials:d}),t.jsx(we,{initials:d,lastBid:a,onScoreSave:c})]}),Y=(e,s)=>e===void 0||s===void 0||e===0?"":e>0?`${e>=100&&e>=s?"🎉 ":""}${e}`:`${e}0 + `,Ae=({initials:e,data:s})=>t.jsxs(se,{"aria-label":"Bid Table",children:[t.jsx(ae,{children:t.jsxs(z,{children:[t.jsx(y,{width:"10%",children:"🥇"}),t.jsxs(y,{children:["Bid",t.jsx("br",{}),"(",e[0]+e[1]+e[2]+e[3],")"]}),t.jsx(y,{children:e[0]+e[2]}),t.jsx(y,{children:e[1]+e[3]})]})}),t.jsx(te,{children:s.map((d,a)=>t.jsxs(z,{children:[t.jsxs(y,{padding:a===s.length-1?"none":void 0,align:"center",children:[d.start,a===s.length-1&&(d.score1?"🃏":"🥇")]}),t.jsx(y,{children:d.bid}),t.jsxs(y,{children:[Y(d.score1,d.score2),d.bags1,d.mod1&&` (${d.mod1})`]}),t.jsxs(y,{children:[Y(d.score2,d.score1),d.bags2,d.mod2&&` (${d.mod2})`]})]},a))})]}),Te=()=>{const e=O(ue),[s,d]=fe(oe),{data:a,first:n,lastBid:o,lifeBags:r,missedBids:c,wins1:m,wins2:x,total1:h,total2:f,nils:B}=s,p=e.reduce((i,l,b)=>b<4?i+l.name[0]:i,"");return{data:a,first:n,initials:p,lastBid:o,lifeBags:r,wins1:m,wins2:x,addBid:i=>{var g;const l=a.length-1;if(a[l]&&((g=a[l])==null?void 0:g.score1)===void 0){const u=[...a];u[l].bid=J(i),d({...s,data:u,lastBid:i});return}const b=[...a];b.push({start:p[n],bid:J(i)}),d({...s,data:b,lastBid:i})},addPenalty:i=>()=>{var b;let l=a.length-1;if(((b=a[l])==null?void 0:b.score1)===void 0&&(l-=1),i===0){const{score1:g,bags1:u,mod1:T}=a[l]||{};if(g===void 0||u===void 0)return;const{score:k,bags:N,mod:P}=U(g,u,T),A=[...a];A[l]={...a[l],score1:k,bags1:N,mod1:P},d({...s,data:A})}else{const{score2:g,bags2:u,mod2:T}=a[l]||{};if(g===void 0||u===void 0)return;const{score:k,bags:N,mod:P}=U(g,u,T),A=[...a];A[l]={...a[l],score2:k,bags2:N,mod2:P},d({...s,data:A})}},addScore:i=>{var X;const l=a.length-1;if(((X=a[l])==null?void 0:X.score1)!==void 0)return;const b=[...a],{score1:g,bags1:u,score2:T,bags2:k}=a[l-1]||{},{score:N,bags:P,mod:A}=K({...o[0],made:i[0]},{...o[2],made:i[2]},g||0,u||0),{score:le,bags:ce,mod:me}=K({...o[1],made:i[1]},{...o[3],made:i[3]},T||0,k||0);b[l]={...a[l],score1:N,bags1:P,mod1:A,score2:le,bags2:ce,mod2:me};const{newNils:he,newMissedBids:xe,newLifeBags:be}=ve(B,r,n,o,i,c);d({...s,data:b,first:(n+1)%4,lastBid:[j,j,j,j],lifeBags:be,missedBids:xe,nils:he})},newGame:()=>{const{score1:i,bags1:l,score2:b,bags2:g}=a[a.length-1],u=i===b&&(l||0)>(g||0)||(i||0)>(b||0);d({...s,data:[],lastBid:[j,j,j,j],wins1:m+(u?1:0),wins2:x+(u?0:1),total1:h+(i||0)*10+(l||0),total2:f+(b||0)*10+(g||0)})}}},ke=({initials:e,wins1:s,wins2:d})=>t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex-container",children:[t.jsx(V,{variant:"h2",component:"h1",children:"♠️🧮"}),t.jsx(H,{avatar:t.jsx(R,{children:e[0]+e[2]}),color:_(s,d),label:s}),t.jsx(H,{avatar:t.jsx(R,{children:e[1]+e[3]}),color:_(d,s),label:d}),t.jsx(Be,{})]})}),Ne=C.memo(()=>{var S,i,l,b,g,u;const{data:e,initials:s,wins1:d,wins2:a,newGame:n,first:o,lastBid:r,addBid:c,addPenalty:m,addScore:x}=Te();let h=e.length-1;((S=e[h])==null?void 0:S.score1)===void 0&&(h-=1);const f=((i=e[h])==null?void 0:i.score1)||0,B=((l=e[h])==null?void 0:l.bags1)||0,p=((b=e[h])==null?void 0:b.score2)||0,v=((g=e[h])==null?void 0:g.bags2)||0,w=f*10+B-(p*10+v),M=w>0?Math.floor(w/100):Math.ceil(w/100);return t.jsxs(t.Fragment,{children:[t.jsx(ke,{initials:s,wins1:d,wins2:a}),f>=100||p>=100?t.jsx(Q,{fullWidth:!0,color:"error",onClick:n,variant:"contained",sx:{marginTop:2},children:"Reset"}):t.jsx(Ce,{blindTrade:M,first:o,initials:s,lastBid:r,showPenalty:((u=e[0])==null?void 0:u.score1)!==void 0,onBidSave:c,onPenalty:m,onScoreSave:x}),t.jsx(Ae,{initials:s,data:e})]})});Ne.displayName="Spades";export{Ne as default};
//# sourceMappingURL=index-B2T2ty_Q.js.map
