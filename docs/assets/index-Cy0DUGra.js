import{Q as b,S as v,D as H,aa as A,r as T,j as h}from"./index-Dfhkglqi.js";import{t as C,s as P,d as j,G as F}from"./GameTable-D4YYtmVi.js";import{p as D,P as I}from"./PlayerMenu-BADgfZDm.js";import{T as M}from"./Header-BCU4WgNm.js";import"./Add-cPr48IYg.js";import"./Remove-BR4n7Ae5.js";import"./Card-BVAY4v6w.js";import"./blueGrey-DU_9M4pp.js";import"./Button-DkBRJ6n7.js";import"./Select-jQRSyeCe.js";import"./isMuiElement-D6c_QvT2.js";import"./useSlotProps-B4yIxVbL.js";import"./Grid2-CxoxNt7x.js";import"./useThemeProps-JycdxBdz.js";import"./TextField-BG_lHKY1.js";var u=(e=>(e.DISCARD_CARDS="Discard Cards",e.END_TURN="End Turn",e.NEW_GAME="New Game",e.START_GAME="Start Game",e))(u||{});const E=()=>({gameFunctions:["Start Game"],cardsToDiscard:[],hideHands:!0,gameOver:!1}),x=b("pokerAtom",E()),U=v(e=>{const r=e(x),t=e(C),a=e(D).slice(0,5);return{poker:r,turn:t,players:a}},(e,r,{poker:t,turn:a,players:n})=>{if(r(x,t),a&&r(C,a),n){const s=e(D);r(D,[...n,s[5],s[6]])}}),S=(e,r)=>{if(r.includes(4))return 7;const t=r.includes(3),a=r.indexOf(2),n=a!==-1;if(t&&n)return 6;if(t)return 3;if(n&&r.includes(2,a+1))return 2;if(n)return 1;const s=r.lastIndexOf(1)-r.indexOf(1)===4||r[12]&&r[0]&&r[1]&&r[2]&&r[3];let o=!0;for(let i=0;i<e.length;i+=1)if(e[i].suit!==e[0].suit){o=!1;break}return s&&o?8:o?5:s?4:0},w=e=>{const r=[0,0,0,0,0,0,0,0,0,0,0,0,0];return e.forEach(t=>{t&&(r[t.weight-2]+=1)}),r},W=e=>{const r=w(e),t=S(e,r),a=["0","0","0","0","0"];let n=0,s=4,o=0,i=-1;for(;n<5;){const l=r.indexOf(s,i+1);l===-1?(s-=1,i=-1):(a[o]=l.toString(14),o+=1,n+=s,i=l)}return`${t}${a.reduce((l,k)=>`${l}${k}`)}`},g=(e,r,t)=>{const a=[],n=[r.indexOf(1)];for(let s=1;s<e;s+=1)n[s]=r.indexOf(1,n[s-1]+1);for(let s=0;s<t.length;s+=1)for(let o=0;o<n.length;o+=1)if(t[s].weight-2===n[o]){a.push(s);break}return a},$=(e,r)=>{if(e.hands.length<1)return e;const t=e.hands[0].cards,a=w(t);switch(S(t,a)){case 0:{const s=a.lastIndexOf(1)>=11?g(4,a,t):[0,1,2,3,4];r(s,e);break}case 1:{const s=g(3,a,t);r(s,e);break}case 2:case 3:{const s=g(1,a,t);r(s,e);break}}},B=e=>{let r={val:0,id:0};e.forEach(t=>{var n;if(((n=t.hands[0])==null?void 0:n.cards.length)<1)return;const a=parseInt(W(t.hands[0].cards),14);a>r.val&&(r={val:a,id:t.id})}),e.forEach((t,a)=>{if(t.id===r.id){const n={...t,status:"win",money:t.money+20};e[a]=n}else{const n={...t,status:"lose",money:t.money-5};e[a]=n}})},J=()=>{const[{poker:{cardsToDiscard:e,gameFunctions:r,gameOver:t,hideHands:a},turn:n,players:s},o]=H(U),i=A(P),l=A(j),k=(c,d)=>{const{hands:m,id:f}=d,p=[...m[0].cards];c.sort().forEach((G,O)=>{p.splice(G-O,1)}),l(c.length,f,p)},N=()=>{var c;if(!a&&!t&&((c=s[n.player])!=null&&c.isBot)){const d=[...s];d.forEach((m,f)=>{n.player<=f&&$(m,k)}),B(d),o({poker:{cardsToDiscard:e,gameFunctions:[u.NEW_GAME],gameOver:!0,hideHands:a},players:d,turn:{player:0,hand:0}})}},R=()=>{i(),s.forEach(c=>{l(5,c.id)}),o({poker:{cardsToDiscard:e,gameFunctions:[u.DISCARD_CARDS],gameOver:t,hideHands:!1}})},_=(c,d,m)=>{k(m,c[d]),o({poker:{cardsToDiscard:[],gameFunctions:[u.END_TURN],gameOver:t,hideHands:a}})};return{checkUpdate:N,cardClickHandler:(c,d,m)=>{const f=[...e],p=f.indexOf(m);p===-1?f.push(m):f.splice(p,1),o({poker:{cardsToDiscard:f,gameFunctions:r,gameOver:t,hideHands:a}})},cardsToDiscard:e,gameFunctions:r,handleGameFunctionClick:c=>{const d=[];switch(c){case u.DISCARD_CARDS:_(s,n.player,e);break;case u.END_TURN:o({poker:{cardsToDiscard:[],gameFunctions:[u.DISCARD_CARDS],gameOver:t,hideHands:a},turn:{player:n.player+1,hand:0}});break;case u.NEW_GAME:s.forEach(m=>d.push({...m,status:"",hands:[],bet:5})),o({poker:E(),turn:{player:0,hand:0},players:d});break;case u.START_GAME:R();break;default:console.error("Unknown Game Function: ",c)}},gameOver:t,hideHands:a,players:s,turn:n}},y=T.memo(()=>h.jsxs("div",{className:"flex-container",children:[h.jsx(M,{variant:"h2",component:"h1",gutterBottom:!0,children:"5 Card Draw Poker"}),h.jsx(I,{})]}));y.displayName="Header";const Q=T.memo(()=>{const{checkUpdate:e,cardClickHandler:r,cardsToDiscard:t,gameFunctions:a,handleGameFunctionClick:n,gameOver:s,hideHands:o,players:i,turn:l}=J();return e(),h.jsxs(h.Fragment,{children:[h.jsx(y,{}),h.jsx(F,{cardClickHandler:r,cardsToDiscard:t,gameFunctions:a,onClick:n,gameOver:s,hideHands:o,isBlackJack:!1,players:i,turn:l})]})});Q.displayName="Poker";export{Q as default};
//# sourceMappingURL=index-Cy0DUGra.js.map
