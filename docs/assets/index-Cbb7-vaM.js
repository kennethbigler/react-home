import{O as K,j as s,r as T,M as L,A as Q}from"./index-CYmon231.js";import{p as U,P as Y}from"./PlayerMenu-f7P72fkv.js";import{I as G}from"./InfoPopup-CNAMYRT6.js";import{A as H}from"./Add-Bk246Ist.js";import{R as F}from"./Remove-CZ82G3tu.js";import{b as C,c as u,T as O,a as V}from"./TableRow-CkV9n6Tk.js";import{I as $,S as W,T as N}from"./Header-BxP8eVDI.js";import{T as X}from"./TableHead-DuAydUTZ.js";import{G as y}from"./Grid2-dUh45gyM.js";import{B as z}from"./Button-DjKAZ2Zn.js";import"./Select-B8uXiK2B.js";import"./isMuiElement-Bfd79aR9.js";import"./useSlotProps-BTTT9OCF.js";import"./useId-Dm-L266R.js";import"./TextField-De7iJlxQ.js";import"./DialogTitle-BE0X_oEj.js";import"./useThemeProps-Cu6N29n3.js";const I=0,D=13,f={bid:3,blind:!1,train:!1},Z={first:0,lastBid:[f,f,f,f],data:[]},p=K("spadesAtom",Z),A=({id:e,blindTrade:a,canTrain:d,bid:n,blind:t,train:i,onBid:r})=>{const o=()=>r(Math.max(n-1,I),!1,!1),c=()=>r(Math.min(n+1,D),!1,!1),g=(m,l)=>r(n,l,!1),S=(m,l)=>r(n,!1,l);return s.jsxs(C,{children:[s.jsx(u,{children:e}),s.jsxs(u,{align:"center",children:[s.jsx($,{onClick:o,disabled:n<=I,children:s.jsx(F,{})}),n,s.jsx($,{onClick:c,disabled:n>=D,children:s.jsx(H,{})})]}),s.jsxs(u,{align:"right",children:[s.jsx(W,{checked:t,inputProps:{"aria-label":`P${e} Blind Nil`},onChange:g,size:"small"}),a||t?a:""]}),s.jsx(u,{align:"right",children:d?s.jsx(W,{checked:i,inputProps:{"aria-label":`P${e} Trains`},onChange:S,size:"small"}):null})]})},P=(e,a)=>e<0&&(a===0||a===2)||e>0&&(a===1||a===3)?Math.min(Math.abs(e),3):0,ee=({blindTrade:e,first:a,initials:d,onBidSave:n})=>{const[t,i]=T.useState([f,f,f,f]),r=(a+0)%4,o=(a+1)%4,c=(a+2)%4,g=(a+3)%4,S=b=>(x,h,j)=>{let B={bid:x,blind:h,train:j};if(h)B={bid:0,blind:h,train:!1};else if(j){let v=10;switch(b){case r:v-=t[c].bid;break;case o:v-=t[g].bid;break;case c:v-=t[r].bid;break;case g:default:v-=t[o].bid}B={bid:v,blind:!1,train:j}}else B={bid:x,blind:!1,train:!1};const w=[...t];w[b]=B,i(w)},m=()=>{n(t),i([f,f,f,f])},l=t.reduce((b,x)=>b-x.bid,13);return s.jsx(G,{title:"+ Bid",onSave:m,children:s.jsxs(O,{"aria-label":"Bid Table",padding:"none",children:[s.jsx(X,{children:s.jsxs(C,{children:[s.jsx(u,{width:"20%",children:"P"}),s.jsxs(u,{width:"40%",align:"center",children:["Bid (",l," 💰)"]}),s.jsx(u,{width:"20%",align:"center",children:"🦮"}),s.jsx(u,{width:"20%",align:"center",children:"🚂"})]})}),s.jsxs(V,{children:[s.jsx(A,{id:d[r]+" 🥇",...t[r],onBid:S(r),blindTrade:P(e,r)}),s.jsx(A,{id:d[o],...t[o],onBid:S(o),blindTrade:P(e,o)}),s.jsx(A,{canTrain:0<t[r].bid&&t[r].bid<10,id:d[c],...t[c],blindTrade:P(e,c),onBid:S(c)}),s.jsx(A,{canTrain:0<t[o].bid&&t[o].bid<10,id:d[g]+" 🃏",...t[g],blindTrade:P(e,g),onBid:S(g)})]})]})})},se=({initials:e,onPenalty:a})=>s.jsx(G,{title:"Penalty",children:s.jsxs(y,{container:!0,spacing:2,children:[s.jsx(y,{size:6,children:s.jsxs(z,{fullWidth:!0,variant:"contained",color:"error",onClick:a(0),children:["Team ",e[0]+e[2]]})}),s.jsx(y,{size:6,children:s.jsxs(z,{fullWidth:!0,variant:"contained",color:"error",onClick:a(1),children:["Team ",e[1]+e[3]]})})]})}),k=({initial:e,lastBid:a,made:d,setMade:n})=>{const t=()=>n(Math.max(d-1,I)),i=()=>n(Math.min(d+1,D));return s.jsxs(y,{size:6,children:[s.jsxs(N,{children:[e," Bid: ",a]}),s.jsxs("div",{children:["Made:",s.jsx($,{onClick:t,disabled:d<=I,children:s.jsx(F,{})}),d,s.jsx($,{onClick:i,disabled:d>=D,children:s.jsx(H,{})})]})]})},ae=({initials:e,lastBid:a,onScoreSave:d})=>{const[n,t]=T.useState(3),[i,r]=T.useState(3),[o,c]=T.useState(3),[g,S]=T.useState(3),m=n+i+o+g,b=m===13?()=>{d([n,i,o,g]),t(3),r(3),c(3),S(3)}:void 0;return s.jsxs(G,{title:"+ Score",onSave:b,children:[s.jsxs(N,{color:m===13?"success":"warning",align:"center",marginBottom:1,children:[m!==13&&"⚠️"," Tricks: ",m]}),s.jsxs(y,{container:!0,spacing:2,children:[s.jsx(k,{initial:e[0],lastBid:a[0].bid,made:n,setMade:t}),s.jsx(k,{initial:e[1],lastBid:a[1].bid,made:i,setMade:r}),s.jsx(k,{initial:e[2],lastBid:a[2].bid,made:o,setMade:c}),s.jsx(k,{initial:e[3],lastBid:a[3].bid,made:g,setMade:S})]})]})},de=({blindTrade:e,first:a,initials:d,lastBid:n,showPenalty:t,onBidSave:i,onPenalty:r,onScoreSave:o})=>s.jsxs("div",{className:"flex-container",style:{margin:"20px 0"},children:[s.jsx(ee,{blindTrade:e,first:a,initials:d,onBidSave:i}),t&&s.jsx(se,{initials:d,onPenalty:r}),s.jsx(ae,{initials:d,lastBid:n,onScoreSave:o})]}),_=(e,a)=>e===void 0||a===void 0||e===0?"":e>0?`${e>100&&e>a?"🎉 ":""}${e}`:`${e}0 + `,ne=({initials:e,data:a})=>s.jsxs(O,{"aria-label":"Bid Table",children:[s.jsx(X,{children:s.jsxs(C,{children:[s.jsx(u,{width:"10%",children:"🥇"}),s.jsxs(u,{children:["Bid",s.jsx("br",{}),"(",e[0]+e[1]+e[2]+e[3],")"]}),s.jsx(u,{children:e[0]+e[2]}),s.jsx(u,{children:e[1]+e[3]})]})}),s.jsx(V,{children:a.map((d,n)=>s.jsxs(C,{children:[s.jsxs(u,{padding:n===a.length-1?"none":void 0,align:"center",children:[d.start,n===a.length-1&&(d.score1?"🃏":"🥇")]}),s.jsx(u,{children:d.bid}),s.jsxs(u,{children:[_(d.score1,d.score2),d.bags1,d.mod1&&` (${d.mod1})`]}),s.jsxs(u,{children:[_(d.score2,d.score1),d.bags2,d.mod2&&` (${d.mod2})`]})]},n))})]}),E=(e,a,d,n)=>{let t=0,i=0,r="";if(e.blind&&a.blind)e.made===0&&a.made===0?t=80:(i=e.made+a.made,r="🚫🚫");else if(e.bid===0&&a.bid===0)e.blind||a.blind?e.made===0&&a.made===0?t=60:e.blind&&e.made===0||a.blind&&a.made===0?(t=30,i=e.made+a.made,r="🚫"):e.made===0||a.made===0?(i=e.made+a.made,r="🚫"):(t=-30,i=e.made+a.made,r="🚫🚫"):e.made===0&&a.made===0?t=40:e.made===0||a.made===0?(i=e.made+a.made,r="🚫"):(t=-20,i=e.made+a.made,r="🚫🚫");else if(e.train||a.train)e.made+a.made>=10?(t=20,i=e.made+a.made-10):(t=-20,r="🚂");else{e.bid===0?e.made===0?t+=e.blind?20:10:(t-=10,i+=e.made,r="🚫"):a.bid===0&&(a.made===0?t+=a.blind?20:10:(t-=10,i+=a.made,r="🚫"));const o=e.bid+a.bid,c=(e.bid>0?e.made:0)+(a.bid>0?a.made:0);c>=o?(t+=o,i+=c-o):(t-=o,r+="🎰")}for(;n+i>=10;)t-=9,i-=10,r+="💰";return{score:d+t,bags:n+i,mod:r}},te=()=>{const e=L(U),[{first:a,lastBid:d,data:n},t]=Q(p),i=[e[0].name[0],e[1].name[0],e[2].name[0],e[3].name[0]],r=m=>{var x;if(n[n.length-1]&&((x=n[n.length-1])==null?void 0:x.score1)===void 0)return;const l=[...n],b={start:i[a],bid:m.reduce((h,j)=>j.train?h+"🚂":j.blind?h+"🦮":j.bid===0?h+"🚫":j.bid>=10?h+`,${j.bid},`:h+j.bid.toString(),"")};l.push(b),t({first:a,lastBid:m,data:l})},o=(m,l,b)=>{let x=l+3,h=b+"😈",j=m;return x>=10&&(j-=9,x-=10,h+="💰"),{newScore:j,newBags:x,newMod:h}};return{first:a,lastBid:d,data:n,initials:i,addBid:r,addPenalty:m=>()=>{var b;let l=n.length-1;if(((b=n[l])==null?void 0:b.score1)===void 0&&(l-=1),m===0){const{score1:x,bags1:h,mod1:j}=n[l]||{};if(x===void 0||h===void 0)return;const{newScore:B,newBags:w,newMod:v}=o(x,h,j||""),M=[...n];M[l]={...n[l],score1:B,bags1:w,mod1:v},t({first:a,lastBid:d,data:M})}else{const{score2:x,bags2:h,mod2:j}=n[l]||{};if(x===void 0||h===void 0)return;const{newScore:B,newBags:w,newMod:v}=o(x,h,j||""),M=[...n];M[l]={...n[l],score2:B,bags2:w,mod2:v},t({first:a,lastBid:d,data:M})}},addScore:m=>{var R;if(((R=n[n.length-1])==null?void 0:R.score1)!==void 0)return;const l=[...n],{score1:b,bags1:x,score2:h,bags2:j}=n[n.length-2]||{},{score:B,bags:w,mod:v}=E({...d[0],made:m[0]},{...d[2],made:m[2]},b||0,x||0),{score:M,bags:q,mod:J}=E({...d[1],made:m[1]},{...d[3],made:m[3]},h||0,j||0);l[n.length-1]={...n[n.length-1],score1:B,bags1:w,mod1:v,score2:M,bags2:q,mod2:J},t({first:(a+1)%4,lastBid:[f,f,f,f],data:l})},newGame:()=>t({first:a,lastBid:[f,f,f,f],data:[]})}},re=T.memo(()=>{var m,l,b,x,h,j,B,w;const{first:e,lastBid:a,data:d,initials:n,addBid:t,addPenalty:i,addScore:r,newGame:o}=te();let c=d.length-1;((m=d[c])==null?void 0:m.score1)===void 0&&(c-=1);const g=(((l=d[c])==null?void 0:l.score1)||0)*10+(((b=d[c])==null?void 0:b.bags1)||0)-((((x=d[c])==null?void 0:x.score2)||0)*10+(((h=d[c])==null?void 0:h.bags2)||0)),S=g>0?Math.floor(g/100):Math.ceil(g/100);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex-container",children:[s.jsx(N,{variant:"h2",component:"h1",children:"♠️ Scores"}),s.jsx(Y,{})]}),(((j=d[d.length-1])==null?void 0:j.score1)||0)>=100||(((B=d[d.length-1])==null?void 0:B.score2)||0)>=100?s.jsx(z,{fullWidth:!0,color:"error",onClick:o,variant:"contained",sx:{marginTop:2},children:"Reset"}):s.jsx(de,{blindTrade:S,first:e,initials:n,lastBid:a,showPenalty:((w=d[c])==null?void 0:w.score1)!==void 0,onBidSave:t,onPenalty:i,onScoreSave:r}),s.jsx(ne,{initials:n,data:d})]})});re.displayName="Spades";export{re as default};
//# sourceMappingURL=index-Cbb7-vaM.js.map
