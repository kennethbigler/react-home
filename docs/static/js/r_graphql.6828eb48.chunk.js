(this["webpackJsonpreact-home"]=this["webpackJsonpreact-home"]||[]).push([[19],{732:function(e,r,t){"use strict";t.r(r),t.d(r,"default",(function(){return K}));var a=t(56),n=t(5),i=t(0),o=t.n(i),s=t(31),c=t(222),d=t(662),b=t(221),u=t(183),l=t.n(u),j=o.a.memo((()=>Object(n.jsx)("div",{children:"Loading ..."})));function p(){var e=Object(b.a)(["\n  fragment repository on Repository {\n    id\n    name\n    url\n    descriptionHTML\n    primaryLanguage {\n      name\n    }\n    owner {\n      login\n      url\n    }\n    stargazers {\n      totalCount\n    }\n    viewerHasStarred\n    watchers {\n      totalCount\n    }\n    viewerSubscription\n  }\n"]);return p=function(){return e},e}var h=l()(p()),m=t(2),v=t(716),O=t(328),g=e=>{var r=e.children,t=Object(O.a)(e,["children"]);return Object(n.jsx)("a",Object(m.a)(Object(m.a)({},t),{},{target:"_blank",rel:"noopener noreferrer",children:r}))},x=e=>{var r=e.descriptionHTML,t=e.primaryLanguage,a=e.owner;return Object(n.jsxs)("div",{className:"RepositoryItem-description",children:[Object(n.jsx)("div",{className:"RepositoryItem-description-info",dangerouslySetInnerHTML:{__html:r}}),Object(n.jsxs)("div",{className:"RepositoryItem-description-details",children:[t&&Object(n.jsxs)(v.a,{display:"inline",children:["Language:"," ",t.name]}),a&&Object(n.jsxs)(v.a,{display:"inline",children:["Owner:"," ",Object(n.jsx)("a",{href:a.url,children:a.login})]})]})]})},f=t(711);function w(){var e=Object(b.a)(["\n  mutation ($id: ID!, $viewerSubscription: SubscriptionState!) {\n    updateSubscription(\n      input: { state: $viewerSubscription, subscribableId: $id }\n    ) {\n      subscribable {\n        id\n        viewerSubscription\n      }\n    }\n  }\n"]);return w=function(){return e},e}var y=l()(w()),S="SUBSCRIBED",C="UNSUBSCRIBED",R=e=>e===S,I=(e,r)=>{var t=r.data;if(t){var a=t.updateSubscription.subscribable,n=a.id,i=a.viewerSubscription,o=e.readFragment({id:"Repository:".concat(n),fragment:h});if(o){var s=o.watchers.totalCount;s=i===S?s+1:s-1,e.writeFragment({id:"Repository:".concat(n),fragment:h,data:Object(m.a)(Object(m.a)({},o),{},{watchers:Object(m.a)(Object(m.a)({},o.watchers),{},{totalCount:s})})})}}},M=e=>{var r=e.id,t=e.watchers,i=e.viewerSubscription,o=Object(c.useMutation)(y,{variables:{id:r,viewerSubscription:R(i)?C:S},optimisticResponse:{updateSubscription:{__typename:"Mutation",subscribable:{__typename:"Repository",id:r,viewerSubscription:R(i)?C:S}}},update:I}),s=Object(a.a)(o,1)[0];return Object(n.jsxs)(f.a,{className:"RepositoryItem-title-action",onClick:s,variant:"outlined",color:"primary",children:[R(i)?"Unwatch":"Watch"," (".concat(t.totalCount,")")]})};function k(){var e=Object(b.a)(["\n  mutation($id: ID!) {\n    addStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]);return k=function(){return e},e}var _=l()(k()),L=(e,r)=>{var t=r.data;if(t){var a=t.addStar.starrable.id,n=e.readFragment({id:"Repository:".concat(a),fragment:h});if(n){var i=n.stargazers.totalCount+1;e.writeFragment({id:"Repository:".concat(a),fragment:h,data:Object(m.a)(Object(m.a)({},n),{},{stargazers:Object(m.a)(Object(m.a)({},n.stargazers),{},{totalCount:i})})})}}},N=e=>{var r=e.id,t=e.stargazers,i=Object(c.useMutation)(_,{variables:{id:r},update:L,optimisticResponse:{addStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:r,viewerHasStarred:!0}}}}),o=Object(a.a)(i,1)[0];return Object(n.jsx)(f.a,{className:"RepositoryItem-title-action",onClick:o,variant:"outlined",color:"primary",children:"Star (".concat(t.totalCount,")")})};function z(){var e=Object(b.a)(["\n  mutation($id: ID!) {\n    removeStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]);return z=function(){return e},e}var H=l()(z()),F=(e,r)=>{var t=r.data;if(t){var a=t.removeStar.starrable.id,n=e.readFragment({id:"Repository:".concat(a),fragment:h});if(n){var i=n.stargazers.totalCount-1;e.writeFragment({id:"Repository:".concat(a),fragment:h,data:Object(m.a)(Object(m.a)({},n),{},{stargazers:Object(m.a)(Object(m.a)({},n.stargazers),{},{totalCount:i})})})}}},T=e=>{var r=e.id,t=e.stargazers,i=Object(c.useMutation)(H,{variables:{id:r},optimisticResponse:{removeStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:r,viewerHasStarred:!1}}},update:F}),o=Object(a.a)(i,1)[0];return Object(n.jsx)(f.a,{className:"RepositoryItem-title-action",onClick:o,variant:"outlined",color:"primary",children:"UnStar (".concat(t.totalCount,")")})},$=e=>{var r=e.id,t=e.name,a=e.url,i=e.descriptionHTML,o=e.primaryLanguage,s=e.owner,c=e.stargazers,d=e.watchers,b=e.viewerSubscription,u=e.viewerHasStarred;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"RepositoryItem-title",children:[Object(n.jsx)(v.a,{variant:"h3",children:Object(n.jsx)(g,{href:a,children:t})}),u?Object(n.jsx)(T,{id:r,stargazers:c}):Object(n.jsx)(N,{id:r,stargazers:c}),Object(n.jsx)(M,{id:r,watchers:d,viewerSubscription:b})]}),Object(n.jsx)(x,{descriptionHTML:i,primaryLanguage:o,owner:s})]})},D=e=>{var r=e.loading,t=e.hasNextPage,a=e.variables,i=e.updateQuery,o=e.fetchMore,s=e.children;return Object(n.jsx)("div",{className:"FetchMore",children:r?Object(n.jsx)(j,{}):t&&Object(n.jsxs)(f.a,{className:"FetchMore-button",onClick:()=>o({variables:a,updateQuery:i}),variant:"outlined",color:"primary",children:["More"," ",s]})})},A=(e,{fetchMoreResult:r})=>r?Object(m.a)(Object(m.a)({},e),{},{viewer:Object(m.a)(Object(m.a)({},e.viewer),{},{repositories:Object(m.a)(Object(m.a)(Object(m.a)({},e.viewer.repositories),r.viewer.repositories),{},{edges:[...e.viewer.repositories.edges,...r.viewer.repositories.edges]})})}):e,B=e=>{var r=e.repositories,t=e.loading,a=e.fetchMore;return Object(n.jsxs)(n.Fragment,{children:[r.edges.map((({node:e})=>Object(n.jsx)("div",{className:"RepositoryItem",children:Object(n.jsx)($,Object(m.a)({},e))},e.id))),Object(n.jsx)(D,{loading:t,hasNextPage:r.pageInfo.hasNextPage,variables:{cursor:r.pageInfo.endCursor},updateQuery:A,fetchMore:a,children:"Repositories"})]})},E=e=>{var r=e.error;return Object(n.jsx)("div",{children:Object(n.jsx)("small",{children:r?r.toString():"Something Went Wrong"})})};function Q(){var e=Object(b.a)(["\n  query($cursor: String) {\n    viewer {\n      repositories(\n        first: 5\n        orderBy: { direction: DESC, field: STARGAZERS }\n        after: $cursor\n      ) {\n        edges {\n          node {\n            ...repository\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n  ","\n"]);return Q=function(){return e},e}var P=l()(Q(),h),U=o.a.memo((()=>{var e=Object(c.useQuery)(P),r=e.error,t=e.data,a=e.loading,i=e.fetchMore;if(r||!t)return Object(n.jsx)(E,{error:r});var o=t.viewer;return a&&!o?Object(n.jsx)(j,{}):Object(n.jsx)(B,{loading:a,repositories:o.repositories,fetchMore:i})})),W=t(77),q=t(758),G=o.a.memo((e=>{var r=e.authToken,t=e.onChange;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(v.a,{variant:"h2",children:"GraphQL Demo"}),Object(n.jsx)(q.a,{label:"Authorization Code",placeholder:"some 32 character string from github",value:r,onChange:t,style:{margin:"20px 0 20px 0"},fullWidth:!0})]})})),J=o.a.memo((()=>Object(n.jsxs)(v.a,{variant:"h6",children:['You need to generate a personal access token with "repo" and "admin:repo_hook" permissions.',Object(n.jsx)("br",{}),"This can be done in the Developer settings on GitHub."]}))),Y=Object(d.a)((({graphQLErrors:e,networkError:r})=>{})),Z=new c.InMemoryCache,K=o.a.memo((()=>{var e=Object(s.c)((e=>e.gqlToken)),r=Object(s.b)(),t=o.a.useState(e),i=Object(a.a)(t,2),d=i[0],b=i[1],u=e=>{var t=e.target.value;r(Object(W.b)(t)),b(t)};if(!e)return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(G,{authToken:d,onChange:u}),Object(n.jsx)(J,{})]});var l=new c.HttpLink({uri:"https://api.github.com/graphql",headers:{authorization:"Bearer ".concat(e)}}),j=c.ApolloLink.from([Y,l]),p=new c.ApolloClient({link:j,cache:Z});return Object(n.jsxs)(c.ApolloProvider,{client:p,children:[Object(n.jsx)(G,{authToken:d,onChange:u}),Object(n.jsx)(U,{})]})}))}}]);
//# sourceMappingURL=r_graphql.6828eb48.chunk.js.map