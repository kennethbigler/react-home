"use strict";(self.webpackChunkreact_home=self.webpackChunkreact_home||[]).push([[591],{16795:function(e,r,n){n.r(r),n.d(r,{default:function(){return ae}});var t,a,i,o,s,c=n(29439),d=n(72791),u=n(4650),l=n(33588),p=n(27603),m=n(3458),h=n(58963),g=n(60377),v=n(56030),f=(0,v.cn)({key:"gqlTokenAtom",default:JSON.parse(localStorage.getItem("gql-token-atom")||'""'),effects:[function(e){(0,e.onSet)((function(e){localStorage.setItem("gql-token-atom",JSON.stringify(e))}))}]}),Z=n(30168),b=n(87743),x=n(96578),w=n(80184),y=d.memo((function(){return(0,w.jsx)("div",{children:"Loading ..."})})),S=(0,b.ZP)(t||(t=(0,Z.Z)(["\n  fragment repository on Repository {\n    id\n    name\n    url\n    descriptionHTML\n    primaryLanguage {\n      name\n    }\n    owner {\n      login\n      url\n    }\n    stargazers {\n      totalCount\n    }\n    viewerHasStarred\n    watchers {\n      totalCount\n    }\n    viewerSubscription\n  }\n"]))),j=n(93433),C=n(1413),R=n(4565),I=n(45987),k=["children"],_=function(e){var r=e.children,n=(0,I.Z)(e,k);return(0,w.jsx)("a",(0,C.Z)((0,C.Z)({},n),{},{target:"_blank",rel:"noopener noreferrer",children:r}))},M=function(e){var r=e.descriptionHTML,n=e.primaryLanguage,t=e.owner;return(0,w.jsxs)("div",{className:"RepositoryItem-description",children:[(0,w.jsx)("div",{className:"RepositoryItem-description-info",dangerouslySetInnerHTML:{__html:r}}),(0,w.jsxs)("div",{className:"RepositoryItem-description-details",children:[n&&(0,w.jsx)(R.Z,{display:"inline",children:"Language: ".concat(n.name)}),t&&(0,w.jsxs)(R.Z,{display:"inline",children:["Owner: ",(0,w.jsx)("a",{href:t.url,children:t.login})]})]})]})},N=n(61091),z=n(84376),F=(0,b.ZP)(a||(a=(0,Z.Z)(["\n  mutation ($id: ID!, $viewerSubscription: SubscriptionState!) {\n    updateSubscription(\n      input: { state: $viewerSubscription, subscribableId: $id }\n    ) {\n      subscribable {\n        id\n        viewerSubscription\n      }\n    }\n  }\n"]))),H="SUBSCRIBED",L="UNSUBSCRIBED",D=function(e){return e===H},T=function(e,r){var n=r.data;if(n){var t=n.updateSubscription.subscribable,a=t.id,i=t.viewerSubscription,o=e.readFragment({id:"Repository:".concat(a),fragment:S});if(o){var s=o.watchers.totalCount;s=i===H?s+1:s-1,e.writeFragment({id:"Repository:".concat(a),fragment:S,data:(0,C.Z)((0,C.Z)({},o),{},{watchers:(0,C.Z)((0,C.Z)({},o.watchers),{},{totalCount:s})})})}}},$=function(e){var r=e.id,n=e.watchers,t=e.viewerSubscription,a=(0,z.D)(F,{variables:{id:r,viewerSubscription:D(t)?L:H},optimisticResponse:{updateSubscription:{__typename:"Mutation",subscribable:{__typename:"Repository",id:r,viewerSubscription:D(t)?L:H}}},update:T}),i=(0,c.Z)(a,1)[0];return(0,w.jsx)(N.Z,{className:"RepositoryItem-title-action",onClick:i,variant:"outlined",color:"secondary",children:"".concat(D(t)?"Unwatch":"Watch"," (").concat(n.totalCount,")")})},P=(0,b.ZP)(i||(i=(0,Z.Z)(["\n  mutation ($id: ID!) {\n    addStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]))),q=function(e,r){var n=r.data;if(n){var t=n.addStar.starrable.id,a=e.readFragment({id:"Repository:".concat(t),fragment:S});if(a){var i=a.stargazers.totalCount+1;e.writeFragment({id:"Repository:".concat(t),fragment:S,data:(0,C.Z)((0,C.Z)({},a),{},{stargazers:(0,C.Z)((0,C.Z)({},a.stargazers),{},{totalCount:i})})})}}},B=function(e){var r=e.id,n=e.stargazers,t=(0,z.D)(P,{variables:{id:r},update:q,optimisticResponse:{addStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:r,viewerHasStarred:!0}}}}),a=(0,c.Z)(t,1)[0];return(0,w.jsx)(N.Z,{className:"RepositoryItem-title-action",onClick:a,variant:"outlined",color:"secondary",children:"Star (".concat(n.totalCount,")")})},U=(0,b.ZP)(o||(o=(0,Z.Z)(["\n  mutation ($id: ID!) {\n    removeStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]))),A=function(e,r){var n=r.data;if(n){var t=n.removeStar.starrable.id,a=e.readFragment({id:"Repository:".concat(t),fragment:S});if(a){var i=a.stargazers.totalCount-1;e.writeFragment({id:"Repository:".concat(t),fragment:S,data:(0,C.Z)((0,C.Z)({},a),{},{stargazers:(0,C.Z)((0,C.Z)({},a.stargazers),{},{totalCount:i})})})}}},E=function(e){var r=e.id,n=e.stargazers,t=(0,z.D)(U,{variables:{id:r},optimisticResponse:{removeStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:r,viewerHasStarred:!1}}},update:A}),a=(0,c.Z)(t,1)[0];return(0,w.jsx)(N.Z,{className:"RepositoryItem-title-action",onClick:a,variant:"outlined",color:"secondary",children:"UnStar (".concat(n.totalCount,")")})},Q=function(e){var r=e.id,n=e.name,t=e.url,a=e.descriptionHTML,i=e.primaryLanguage,o=e.owner,s=e.stargazers,c=e.watchers,d=e.viewerSubscription,u=e.viewerHasStarred;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{className:"RepositoryItem-title",children:[(0,w.jsx)(R.Z,{variant:"h3",children:(0,w.jsx)(_,{href:t,children:n})}),u?(0,w.jsx)(E,{id:r,stargazers:s}):(0,w.jsx)(B,{id:r,stargazers:s}),(0,w.jsx)($,{id:r,watchers:c,viewerSubscription:d})]}),(0,w.jsx)(M,{descriptionHTML:a,primaryLanguage:i,owner:o})]})},W=function(e){var r=e.loading,n=e.hasNextPage,t=e.variables,a=e.updateQuery,i=e.fetchMore,o=e.children;return(0,w.jsx)("div",{className:"FetchMore",children:r?(0,w.jsx)(y,{}):n&&(0,w.jsx)(N.Z,{className:"FetchMore-button",onClick:function(){return i({variables:t,updateQuery:a})},variant:"outlined",color:"secondary",children:"More ".concat(o||"")})})},G=function(e,r){var n=r.fetchMoreResult;return n?(0,C.Z)((0,C.Z)({},e),{},{viewer:(0,C.Z)((0,C.Z)({},e.viewer),{},{repositories:(0,C.Z)((0,C.Z)((0,C.Z)({},e.viewer.repositories),n.viewer.repositories),{},{edges:[].concat((0,j.Z)(e.viewer.repositories.edges),(0,j.Z)(n.viewer.repositories.edges))})})}):e},O=function(e){var r=e.repositories,n=e.loading,t=e.fetchMore;return(0,w.jsxs)(w.Fragment,{children:[r.edges.map((function(e){var r=e.node;return(0,w.jsx)("div",{className:"RepositoryItem",children:(0,w.jsx)(Q,(0,C.Z)({},r))},r.id)})),(0,w.jsx)(W,{loading:n,hasNextPage:r.pageInfo.hasNextPage,variables:{cursor:r.pageInfo.endCursor},updateQuery:G,fetchMore:t,children:"Repositories"})]})},J=function(e){var r=e.error;return(0,w.jsx)("div",{children:(0,w.jsx)("small",{children:r?r.toString():"Something Went Wrong"})})},V=(0,b.ZP)(s||(s=(0,Z.Z)(["\n  query ($cursor: String) {\n    viewer {\n      repositories(\n        first: 5\n        orderBy: { direction: DESC, field: STARGAZERS }\n        after: $cursor\n      ) {\n        edges {\n          node {\n            ...repository\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n  ","\n"])),S),Y=d.memo((function(){var e=(0,x.a)(V),r=e.error,n=e.data,t=e.loading,a=e.fetchMore;return r||!t&&!n?(0,w.jsx)(J,{error:r}):n&&n.viewer&&!t?(0,w.jsx)(O,{loading:t,repositories:n.viewer.repositories,fetchMore:a}):(0,w.jsx)(y,{})})),K=Y,X=n(75017),ee=d.memo((function(e){var r=e.authToken,n=e.onChange;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(R.Z,{variant:"h2",component:"h1",children:"GraphQL Demo"}),(0,w.jsx)(X.Z,{label:"Authorization Code",placeholder:"some 32 character string from github",value:r,onChange:n,style:{margin:"20px 0 20px 0"},fullWidth:!0})]})})),re=d.memo((function(){return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(R.Z,{children:'You need to generate a personal access token with "repo" and "admin:repo_hook" permissions.'}),(0,w.jsx)(R.Z,{children:"This can be done in the Developer settings on GitHub."})]})})),ne=(0,g.q)((function(){})),te=new u.h,ae=d.memo((function(){var e=(0,v.FV)(f),r=(0,c.Z)(e,2),n=r[0],t=r[1],a=function(e){return t(e.target.value)};if(!n)return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(ee,{authToken:n,onChange:a}),(0,w.jsx)(re,{})]});var i=new l.u({uri:"https://api.github.com/graphql",headers:{authorization:"Bearer ".concat(n)}}),o=p.i.from([ne,i]),s=new m.f({link:o,cache:te});return(0,w.jsxs)(h.e,{client:s,children:[(0,w.jsx)(ee,{authToken:n,onChange:a}),(0,w.jsx)(K,{})]})}))}}]);
//# sourceMappingURL=r_graphql.3adff5f9.chunk.js.map