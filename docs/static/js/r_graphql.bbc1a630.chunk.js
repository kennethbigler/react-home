(this["webpackJsonpreact-home"]=this["webpackJsonpreact-home"]||[]).push([[20],{756:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return K}));var r=a(53),n=a(0),i=a.n(n),o=a(32),c=a(235),s=a(682),u=a(234),l=a(186),m=a.n(l),d=i.a.memo((function(){return i.a.createElement("div",null,"Loading ...")}));function p(){var e=Object(u.a)(["\n  fragment repository on Repository {\n    id\n    name\n    url\n    descriptionHTML\n    primaryLanguage {\n      name\n    }\n    owner {\n      login\n      url\n    }\n    stargazers {\n      totalCount\n    }\n    viewerHasStarred\n    watchers {\n      totalCount\n    }\n    viewerSubscription\n  }\n"]);return p=function(){return e},e}var b=m()(p()),v=a(10),g=a(1),f=a(740),h=a(342),E=function(e){var t=e.children,a=Object(h.a)(e,["children"]);return i.a.createElement("a",Object.assign({},a,{target:"_blank",rel:"noopener noreferrer"}),t)},w=function(e){var t=e.descriptionHTML,a=e.primaryLanguage,r=e.owner;return i.a.createElement("div",{className:"RepositoryItem-description"},i.a.createElement("div",{className:"RepositoryItem-description-info",dangerouslySetInnerHTML:{__html:t}}),i.a.createElement("div",{className:"RepositoryItem-description-details"},a&&i.a.createElement(f.a,{display:"inline"},"Language:"," ",a.name),r&&i.a.createElement(f.a,{display:"inline"},"Owner:"," ",i.a.createElement("a",{href:r.url},r.login))))},y=a(735);function O(){var e=Object(u.a)(["\n  mutation ($id: ID!, $viewerSubscription: SubscriptionState!) {\n    updateSubscription(\n      input: { state: $viewerSubscription, subscribableId: $id }\n    ) {\n      subscribable {\n        id\n        viewerSubscription\n      }\n    }\n  }\n"]);return O=function(){return e},e}var S=m()(O()),j="SUBSCRIBED",C="UNSUBSCRIBED",R=function(e){return e===j},I=function(e,t){var a=t.data;if(a){var r=a.updateSubscription.subscribable,n=r.id,i=r.viewerSubscription,o=e.readFragment({id:"Repository:".concat(n),fragment:b});if(o){var c=o.watchers.totalCount;c=i===j?c+1:c-1,e.writeFragment({id:"Repository:".concat(n),fragment:b,data:Object(g.a)(Object(g.a)({},o),{},{watchers:Object(g.a)(Object(g.a)({},o.watchers),{},{totalCount:c})})})}}},M=function(e){var t=e.id,a=e.watchers,n=e.viewerSubscription,o=Object(c.useMutation)(S,{variables:{id:t,viewerSubscription:R(n)?C:j},optimisticResponse:{updateSubscription:{__typename:"Mutation",subscribable:{__typename:"Repository",id:t,viewerSubscription:R(n)?C:j}}},update:I}),s=Object(r.a)(o,1)[0];return i.a.createElement(y.a,{className:"RepositoryItem-title-action",onClick:s,variant:"outlined",color:"primary"},R(n)?"Unwatch":"Watch"," (".concat(a.totalCount,")"))};function k(){var e=Object(u.a)(["\n  mutation($id: ID!) {\n    addStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]);return k=function(){return e},e}var _=m()(k()),L=function(e,t){var a=t.data;if(a){var r=a.addStar.starrable.id,n=e.readFragment({id:"Repository:".concat(r),fragment:b});if(n){var i=n.stargazers.totalCount+1;e.writeFragment({id:"Repository:".concat(r),fragment:b,data:Object(g.a)(Object(g.a)({},n),{},{stargazers:Object(g.a)(Object(g.a)({},n.stargazers),{},{totalCount:i})})})}}},N=function(e){var t=e.id,a=e.stargazers,n=Object(c.useMutation)(_,{variables:{id:t},update:L,optimisticResponse:{addStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:t,viewerHasStarred:!0}}}}),o=Object(r.a)(n,1)[0];return i.a.createElement(y.a,{className:"RepositoryItem-title-action",onClick:o,variant:"outlined",color:"primary"},"Star (".concat(a.totalCount,")"))};function z(){var e=Object(u.a)(["\n  mutation($id: ID!) {\n    removeStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]);return z=function(){return e},e}var H=m()(z()),F=function(e,t){var a=t.data;if(a){var r=a.removeStar.starrable.id,n=e.readFragment({id:"Repository:".concat(r),fragment:b});if(n){var i=n.stargazers.totalCount-1;e.writeFragment({id:"Repository:".concat(r),fragment:b,data:Object(g.a)(Object(g.a)({},n),{},{stargazers:Object(g.a)(Object(g.a)({},n.stargazers),{},{totalCount:i})})})}}},T=function(e){var t=e.id,a=e.stargazers,n=Object(c.useMutation)(H,{variables:{id:t},optimisticResponse:{removeStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:t,viewerHasStarred:!1}}},update:F}),o=Object(r.a)(n,1)[0];return i.a.createElement(y.a,{className:"RepositoryItem-title-action",onClick:o,variant:"outlined",color:"primary"},"UnStar (".concat(a.totalCount,")"))},$=function(e){var t=e.id,a=e.name,r=e.url,n=e.descriptionHTML,o=e.primaryLanguage,c=e.owner,s=e.stargazers,u=e.watchers,l=e.viewerSubscription,m=e.viewerHasStarred;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"RepositoryItem-title"},i.a.createElement(f.a,{variant:"h3"},i.a.createElement(E,{href:r},a)),m?i.a.createElement(T,{id:t,stargazers:s}):i.a.createElement(N,{id:t,stargazers:s}),i.a.createElement(M,{id:t,watchers:u,viewerSubscription:l})),i.a.createElement(w,{descriptionHTML:n,primaryLanguage:o,owner:c}))},D=function(e){var t=e.loading,a=e.hasNextPage,r=e.variables,n=e.updateQuery,o=e.fetchMore,c=e.children;return i.a.createElement("div",{className:"FetchMore"},t?i.a.createElement(d,null):a&&i.a.createElement(y.a,{className:"FetchMore-button",onClick:function(){return o({variables:r,updateQuery:n})},variant:"outlined",color:"primary"},"More"," ",c))},x=function(e,t){var a=t.fetchMoreResult;return a?Object(g.a)(Object(g.a)({},e),{},{viewer:Object(g.a)(Object(g.a)({},e.viewer),{},{repositories:Object(g.a)(Object(g.a)(Object(g.a)({},e.viewer.repositories),a.viewer.repositories),{},{edges:[].concat(Object(v.a)(e.viewer.repositories.edges),Object(v.a)(a.viewer.repositories.edges))})})}):e},A=function(e){var t=e.repositories,a=e.loading,r=e.fetchMore;return i.a.createElement(i.a.Fragment,null,t.edges.map((function(e){var t=e.node;return i.a.createElement("div",{key:t.id,className:"RepositoryItem"},i.a.createElement($,t))})),i.a.createElement(D,{loading:a,hasNextPage:t.pageInfo.hasNextPage,variables:{cursor:t.pageInfo.endCursor},updateQuery:x,fetchMore:r},"Repositories"))},B=function(e){var t=e.error;return i.a.createElement("div",null,i.a.createElement("small",null,t?t.toString():"Something Went Wrong"))};function Q(){var e=Object(u.a)(["\n  query($cursor: String) {\n    viewer {\n      repositories(\n        first: 5\n        orderBy: { direction: DESC, field: STARGAZERS }\n        after: $cursor\n      ) {\n        edges {\n          node {\n            ...repository\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n  ","\n"]);return Q=function(){return e},e}var P=m()(Q(),b),U=i.a.memo((function(){var e=Object(c.useQuery)(P),t=e.error,a=e.data,r=e.loading,n=e.fetchMore;if(t||!a)return i.a.createElement(B,{error:t});var o=a.viewer;return r&&!o?i.a.createElement(d,null):i.a.createElement(A,{loading:r,repositories:o.repositories,fetchMore:n})})),W=a(72),q=a(787),G=i.a.memo((function(e){var t=e.authToken,a=e.onChange;return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{variant:"h2"},"GraphQL Demo"),i.a.createElement(q.a,{label:"Authorization Code",placeholder:"some 32 character string from github",value:t,onChange:a,style:{margin:"20px 0 20px 0"},fullWidth:!0}))})),J=i.a.memo((function(){return i.a.createElement(f.a,{variant:"h6"},'You need to generate a personal access token with "repo" and "admin:repo_hook" permissions.',i.a.createElement("br",null),"This can be done in the Developer settings on GitHub.")})),Y=Object(s.a)((function(e){e.graphQLErrors,e.networkError})),Z=new c.InMemoryCache,K=i.a.memo((function(){var e=Object(o.c)((function(e){return e.gqlToken})),t=Object(o.b)(),a=i.a.useState(e),n=Object(r.a)(a,2),s=n[0],u=n[1],l=function(e){var a=e.target.value;t(Object(W.b)(a)),u(a)};if(!e)return i.a.createElement(i.a.Fragment,null,i.a.createElement(G,{authToken:s,onChange:l}),i.a.createElement(J,null));var m=new c.HttpLink({uri:"https://api.github.com/graphql",headers:{authorization:"Bearer ".concat(e)}}),d=c.ApolloLink.from([Y,m]),p=new c.ApolloClient({link:d,cache:Z});return i.a.createElement(c.ApolloProvider,{client:p},i.a.createElement(G,{authToken:s,onChange:l}),i.a.createElement(U,null))}))}}]);
//# sourceMappingURL=r_graphql.bbc1a630.chunk.js.map