(this["webpackJsonpreact-home"]=this["webpackJsonpreact-home"]||[]).push([[20],{702:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return ae}));var a,n,i,o,c,s=r(58),d=r(0),b=r.n(d),u=r(33),j=r(708),l=r(706),p=r(634),O=r(705),h=r(697),m=r(616),g=r(243),v=r(247),f=r(724),x=r(5),w=b.a.memo((function(){return Object(x.jsx)("div",{children:"Loading ..."})})),y=Object(v.a)(a||(a=Object(g.a)(["\n  fragment repository on Repository {\n    id\n    name\n    url\n    descriptionHTML\n    primaryLanguage {\n      name\n    }\n    owner {\n      login\n      url\n    }\n    stargazers {\n      totalCount\n    }\n    viewerHasStarred\n    watchers {\n      totalCount\n    }\n    viewerSubscription\n  }\n"]))),S=r(10),R=r(1),C=r(671),I=r(351),M=function(e){var t=e.children,r=Object(I.a)(e,["children"]);return Object(x.jsx)("a",Object(R.a)(Object(R.a)({},r),{},{target:"_blank",rel:"noopener noreferrer",children:t}))},_=function(e){var t=e.descriptionHTML,r=e.primaryLanguage,a=e.owner;return Object(x.jsxs)("div",{className:"RepositoryItem-description",children:[Object(x.jsx)("div",{className:"RepositoryItem-description-info",dangerouslySetInnerHTML:{__html:t}}),Object(x.jsxs)("div",{className:"RepositoryItem-description-details",children:[r&&Object(x.jsx)(C.a,{display:"inline",children:"Language: ".concat(r.name)}),a&&Object(x.jsxs)(C.a,{display:"inline",children:["Owner:"," ",Object(x.jsx)("a",{href:a.url,children:a.login})]})]})]})},N=r(666),k=r(744),z=Object(v.a)(n||(n=Object(g.a)(["\n  mutation ($id: ID!, $viewerSubscription: SubscriptionState!) {\n    updateSubscription(\n      input: { state: $viewerSubscription, subscribableId: $id }\n    ) {\n      subscribable {\n        id\n        viewerSubscription\n      }\n    }\n  }\n"]))),F="SUBSCRIBED",H="UNSUBSCRIBED",L=function(e){return e===F},T=function(e,t){var r=t.data;if(r){var a=r.updateSubscription.subscribable,n=a.id,i=a.viewerSubscription,o=e.readFragment({id:"Repository:".concat(n),fragment:y});if(o){var c=o.watchers.totalCount;c=i===F?c+1:c-1,e.writeFragment({id:"Repository:".concat(n),fragment:y,data:Object(R.a)(Object(R.a)({},o),{},{watchers:Object(R.a)(Object(R.a)({},o.watchers),{},{totalCount:c})})})}}},$=function(e){var t=e.id,r=e.watchers,a=e.viewerSubscription,n=Object(k.a)(z,{variables:{id:t,viewerSubscription:L(a)?H:F},optimisticResponse:{updateSubscription:{__typename:"Mutation",subscribable:{__typename:"Repository",id:t,viewerSubscription:L(a)?H:F}}},update:T}),i=Object(s.a)(n,1)[0];return Object(x.jsx)(N.a,{className:"RepositoryItem-title-action",onClick:i,variant:"outlined",color:"primary",children:"".concat(L(a)?"Unwatch":"Watch"," (").concat(r.totalCount,")")})},D=Object(v.a)(i||(i=Object(g.a)(["\n  mutation($id: ID!) {\n    addStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]))),B=function(e,t){var r=t.data;if(r){var a=r.addStar.starrable.id,n=e.readFragment({id:"Repository:".concat(a),fragment:y});if(n){var i=n.stargazers.totalCount+1;e.writeFragment({id:"Repository:".concat(a),fragment:y,data:Object(R.a)(Object(R.a)({},n),{},{stargazers:Object(R.a)(Object(R.a)({},n.stargazers),{},{totalCount:i})})})}}},U=function(e){var t=e.id,r=e.stargazers,a=Object(k.a)(D,{variables:{id:t},update:B,optimisticResponse:{addStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:t,viewerHasStarred:!0}}}}),n=Object(s.a)(a,1)[0];return Object(x.jsx)(N.a,{className:"RepositoryItem-title-action",onClick:n,variant:"outlined",color:"primary",children:"Star (".concat(r.totalCount,")")})},E=Object(v.a)(o||(o=Object(g.a)(["\n  mutation($id: ID!) {\n    removeStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]))),P=function(e,t){var r=t.data;if(r){var a=r.removeStar.starrable.id,n=e.readFragment({id:"Repository:".concat(a),fragment:y});if(n){var i=n.stargazers.totalCount-1;e.writeFragment({id:"Repository:".concat(a),fragment:y,data:Object(R.a)(Object(R.a)({},n),{},{stargazers:Object(R.a)(Object(R.a)({},n.stargazers),{},{totalCount:i})})})}}},Q=function(e){var t=e.id,r=e.stargazers,a=Object(k.a)(E,{variables:{id:t},optimisticResponse:{removeStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:t,viewerHasStarred:!1}}},update:P}),n=Object(s.a)(a,1)[0];return Object(x.jsx)(N.a,{className:"RepositoryItem-title-action",onClick:n,variant:"outlined",color:"primary",children:"UnStar (".concat(r.totalCount,")")})},W=function(e){var t=e.id,r=e.name,a=e.url,n=e.descriptionHTML,i=e.primaryLanguage,o=e.owner,c=e.stargazers,s=e.watchers,d=e.viewerSubscription,b=e.viewerHasStarred;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"RepositoryItem-title",children:[Object(x.jsx)(C.a,{variant:"h3",children:Object(x.jsx)(M,{href:a,children:r})}),b?Object(x.jsx)(Q,{id:t,stargazers:c}):Object(x.jsx)(U,{id:t,stargazers:c}),Object(x.jsx)($,{id:t,watchers:s,viewerSubscription:d})]}),Object(x.jsx)(_,{descriptionHTML:n,primaryLanguage:i,owner:o})]})},q=function(e){var t=e.loading,r=e.hasNextPage,a=e.variables,n=e.updateQuery,i=e.fetchMore,o=e.children;return Object(x.jsx)("div",{className:"FetchMore",children:t?Object(x.jsx)(w,{}):r&&Object(x.jsx)(N.a,{className:"FetchMore-button",onClick:function(){return i({variables:a,updateQuery:n})},variant:"outlined",color:"primary",children:"More ".concat(o)})})},A=function(e,t){var r=t.fetchMoreResult;return r?Object(R.a)(Object(R.a)({},e),{},{viewer:Object(R.a)(Object(R.a)({},e.viewer),{},{repositories:Object(R.a)(Object(R.a)(Object(R.a)({},e.viewer.repositories),r.viewer.repositories),{},{edges:[].concat(Object(S.a)(e.viewer.repositories.edges),Object(S.a)(r.viewer.repositories.edges))})})}):e},G=function(e){var t=e.repositories,r=e.loading,a=e.fetchMore;return Object(x.jsxs)(x.Fragment,{children:[t.edges.map((function(e){var t=e.node;return Object(x.jsx)("div",{className:"RepositoryItem",children:Object(x.jsx)(W,Object(R.a)({},t))},t.id)})),Object(x.jsx)(q,{loading:r,hasNextPage:t.pageInfo.hasNextPage,variables:{cursor:t.pageInfo.endCursor},updateQuery:A,fetchMore:a,children:"Repositories"})]})},J=function(e){var t=e.error;return Object(x.jsx)("div",{children:Object(x.jsx)("small",{children:t?t.toString():"Something Went Wrong"})})},Y=Object(v.a)(c||(c=Object(g.a)(["\n  query($cursor: String) {\n    viewer {\n      repositories(\n        first: 5\n        orderBy: { direction: DESC, field: STARGAZERS }\n        after: $cursor\n      ) {\n        edges {\n          node {\n            ...repository\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n  ","\n"])),y),Z=b.a.memo((function(){var e=Object(f.a)(Y),t=e.error,r=e.data,a=e.loading,n=e.fetchMore;return t||!a&&!r?Object(x.jsx)(J,{error:t}):!a||r&&r.viewer?Object(x.jsx)(G,{loading:a,repositories:r.viewer.repositories,fetchMore:n}):Object(x.jsx)(w,{})})),K=r(82),V=r(736),X=b.a.memo((function(e){var t=e.authToken,r=e.onChange;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(C.a,{variant:"h2",children:"GraphQL Demo"}),Object(x.jsx)(V.a,{label:"Authorization Code",placeholder:"some 32 character string from github",value:t,onChange:r,style:{margin:"20px 0 20px 0"},fullWidth:!0})]})})),ee=b.a.memo((function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(C.a,{variant:"h6",children:'You need to generate a personal access token with "repo" and "admin:repo_hook" permissions.'}),Object(x.jsx)(C.a,{variant:"h6",children:"This can be done in the Developer settings on GitHub."})]})})),te=Object(m.a)((function(){})),re=new j.a,ae=b.a.memo((function(){var e=Object(u.c)((function(e){return e.gqlToken})),t=Object(u.b)(),r=b.a.useState(e),a=Object(s.a)(r,2),n=a[0],i=a[1],o=function(e){var r=e.target.value;t(Object(K.b)(r)),i(r)};if(!e)return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(X,{authToken:n,onChange:o}),Object(x.jsx)(ee,{})]});var c=new l.a({uri:"https://api.github.com/graphql",headers:{authorization:"Bearer ".concat(e)}}),d=p.a.from([te,c]),j=new O.a({link:d,cache:re});return Object(x.jsxs)(h.a,{client:j,children:[Object(x.jsx)(X,{authToken:n,onChange:o}),Object(x.jsx)(Z,{})]})}))}}]);
//# sourceMappingURL=r_graphql.0dfb64fb.chunk.js.map