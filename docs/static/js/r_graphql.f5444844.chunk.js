(this["webpackJsonpreact-home"]=this["webpackJsonpreact-home"]||[]).push([[20],{687:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Z}));var a=r(55),n=r(0),i=r.n(n),s=r(31),o=r(244),c=r(602),d=r(243),b=r(199),l=r(5);var j,u=i.a.memo((()=>Object(l.jsx)("div",{children:"Loading ..."})));var p=Object(b.a)(j||(j=Object(d.a)(["\n  fragment repository on Repository {\n    id\n    name\n    url\n    descriptionHTML\n    primaryLanguage {\n      name\n    }\n    owner {\n      login\n      url\n    }\n    stargazers {\n      totalCount\n    }\n    viewerHasStarred\n    watchers {\n      totalCount\n    }\n    viewerSubscription\n  }\n"]))),h=r(1),O=r(662),m=r(347);var g=e=>{const t=e.children,r=Object(m.a)(e,["children"]);return Object(l.jsx)("a",Object(h.a)(Object(h.a)({},r),{},{target:"_blank",rel:"noopener noreferrer",children:t}))};var v,x=e=>{const t=e.descriptionHTML,r=e.primaryLanguage,a=e.owner;return Object(l.jsxs)("div",{className:"RepositoryItem-description",children:[Object(l.jsx)("div",{className:"RepositoryItem-description-info",dangerouslySetInnerHTML:{__html:t}}),Object(l.jsxs)("div",{className:"RepositoryItem-description-details",children:[r&&Object(l.jsx)(O.a,{display:"inline",children:"Language: ".concat(r.name)}),a&&Object(l.jsxs)(O.a,{display:"inline",children:["Owner:"," ",Object(l.jsx)("a",{href:a.url,children:a.login})]})]})]})},w=r(657);const y=Object(b.a)(v||(v=Object(d.a)(["\n  mutation ($id: ID!, $viewerSubscription: SubscriptionState!) {\n    updateSubscription(\n      input: { state: $viewerSubscription, subscribableId: $id }\n    ) {\n      subscribable {\n        id\n        viewerSubscription\n      }\n    }\n  }\n"]))),S="SUBSCRIBED",f="UNSUBSCRIBED",C=e=>e===S,R=(e,t)=>{const r=t.data;if(!r)return;const a=r.updateSubscription.subscribable,n=a.id,i=a.viewerSubscription,s=e.readFragment({id:"Repository:".concat(n),fragment:p});if(!s)return;let o=s.watchers.totalCount;o=i===S?o+1:o-1,e.writeFragment({id:"Repository:".concat(n),fragment:p,data:Object(h.a)(Object(h.a)({},s),{},{watchers:Object(h.a)(Object(h.a)({},s.watchers),{},{totalCount:o})})})};var I,M=e=>{const t=e.id,r=e.watchers,n=e.viewerSubscription,i=Object(o.useMutation)(y,{variables:{id:t,viewerSubscription:C(n)?f:S},optimisticResponse:{updateSubscription:{__typename:"Mutation",subscribable:{__typename:"Repository",id:t,viewerSubscription:C(n)?f:S}}},update:R}),s=Object(a.a)(i,1)[0];return Object(l.jsx)(w.a,{className:"RepositoryItem-title-action",onClick:s,variant:"outlined",color:"primary",children:"".concat(C(n)?"Unwatch":"Watch"," (").concat(r.totalCount,")")})};const k=Object(b.a)(I||(I=Object(d.a)(["\n  mutation($id: ID!) {\n    addStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]))),_=(e,t)=>{const r=t.data;if(!r)return;const a=r.addStar.starrable.id,n=e.readFragment({id:"Repository:".concat(a),fragment:p});if(!n)return;const i=n.stargazers.totalCount+1;e.writeFragment({id:"Repository:".concat(a),fragment:p,data:Object(h.a)(Object(h.a)({},n),{},{stargazers:Object(h.a)(Object(h.a)({},n.stargazers),{},{totalCount:i})})})};var N,z=e=>{const t=e.id,r=e.stargazers,n=Object(o.useMutation)(k,{variables:{id:t},update:_,optimisticResponse:{addStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:t,viewerHasStarred:!0}}}}),i=Object(a.a)(n,1)[0];return Object(l.jsx)(w.a,{className:"RepositoryItem-title-action",onClick:i,variant:"outlined",color:"primary",children:"Star (".concat(r.totalCount,")")})};const L=Object(b.a)(N||(N=Object(d.a)(["\n  mutation($id: ID!) {\n    removeStar(input: { starrableId: $id }) {\n      starrable {\n        id\n        viewerHasStarred\n      }\n    }\n  }\n"]))),F=(e,t)=>{const r=t.data;if(!r)return;const a=r.removeStar.starrable.id,n=e.readFragment({id:"Repository:".concat(a),fragment:p});if(!n)return;const i=n.stargazers.totalCount-1;e.writeFragment({id:"Repository:".concat(a),fragment:p,data:Object(h.a)(Object(h.a)({},n),{},{stargazers:Object(h.a)(Object(h.a)({},n.stargazers),{},{totalCount:i})})})};var H=e=>{const t=e.id,r=e.stargazers,n=Object(o.useMutation)(L,{variables:{id:t},optimisticResponse:{removeStar:{__typename:"Mutation",starrable:{__typename:"Repository",id:t,viewerHasStarred:!1}}},update:F}),i=Object(a.a)(n,1)[0];return Object(l.jsx)(w.a,{className:"RepositoryItem-title-action",onClick:i,variant:"outlined",color:"primary",children:"UnStar (".concat(r.totalCount,")")})};var T=e=>{const t=e.id,r=e.name,a=e.url,n=e.descriptionHTML,i=e.primaryLanguage,s=e.owner,o=e.stargazers,c=e.watchers,d=e.viewerSubscription,b=e.viewerHasStarred;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:"RepositoryItem-title",children:[Object(l.jsx)(O.a,{variant:"h3",children:Object(l.jsx)(g,{href:a,children:r})}),b?Object(l.jsx)(H,{id:t,stargazers:o}):Object(l.jsx)(z,{id:t,stargazers:o}),Object(l.jsx)(M,{id:t,watchers:c,viewerSubscription:d})]}),Object(l.jsx)(x,{descriptionHTML:n,primaryLanguage:i,owner:s})]})};var $=e=>{const t=e.loading,r=e.hasNextPage,a=e.variables,n=e.updateQuery,i=e.fetchMore,s=e.children;return Object(l.jsx)("div",{className:"FetchMore",children:t?Object(l.jsx)(u,{}):r&&Object(l.jsx)(w.a,{className:"FetchMore-button",onClick:()=>i({variables:a,updateQuery:n}),variant:"outlined",color:"primary",children:"More ".concat(s)})})};const D=(e,{fetchMoreResult:t})=>t?Object(h.a)(Object(h.a)({},e),{},{viewer:Object(h.a)(Object(h.a)({},e.viewer),{},{repositories:Object(h.a)(Object(h.a)(Object(h.a)({},e.viewer.repositories),t.viewer.repositories),{},{edges:[...e.viewer.repositories.edges,...t.viewer.repositories.edges]})})}):e;var A=e=>{const t=e.repositories,r=e.loading,a=e.fetchMore;return Object(l.jsxs)(l.Fragment,{children:[t.edges.map((({node:e})=>Object(l.jsx)("div",{className:"RepositoryItem",children:Object(l.jsx)(T,Object(h.a)({},e))},e.id))),Object(l.jsx)($,{loading:r,hasNextPage:t.pageInfo.hasNextPage,variables:{cursor:t.pageInfo.endCursor},updateQuery:D,fetchMore:a,children:"Repositories"})]})};var B,P=e=>{const t=e.error;return Object(l.jsx)("div",{children:Object(l.jsx)("small",{children:t?t.toString():"Something Went Wrong"})})};const Q=Object(b.a)(B||(B=Object(d.a)(["\n  query($cursor: String) {\n    viewer {\n      repositories(\n        first: 5\n        orderBy: { direction: DESC, field: STARGAZERS }\n        after: $cursor\n      ) {\n        edges {\n          node {\n            ...repository\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n  ","\n"])),p);var U=i.a.memo((()=>{const e=Object(o.useQuery)(Q),t=e.error,r=e.data,a=e.loading,n=e.fetchMore;return t||!a&&!r?Object(l.jsx)(P,{error:t}):!a||r&&r.viewer?Object(l.jsx)(A,{loading:a,repositories:r.viewer.repositories,fetchMore:n}):Object(l.jsx)(u,{})})),E=r(77),W=r(711);var q=i.a.memo((e=>{const t=e.authToken,r=e.onChange;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(O.a,{variant:"h2",children:"GraphQL Demo"}),Object(l.jsx)(W.a,{label:"Authorization Code",placeholder:"some 32 character string from github",value:t,onChange:r,style:{margin:"20px 0 20px 0"},fullWidth:!0})]})}));var G=i.a.memo((()=>Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(O.a,{variant:"h6",children:'You need to generate a personal access token with "repo" and "admin:repo_hook" permissions.'}),Object(l.jsx)(O.a,{variant:"h6",children:"This can be done in the Developer settings on GitHub."})]})));const J=Object(c.a)((()=>{})),Y=new o.InMemoryCache;var Z=i.a.memo((()=>{const e=Object(s.c)((e=>e.gqlToken)),t=Object(s.b)(),r=i.a.useState(e),n=Object(a.a)(r,2),c=n[0],d=n[1],b=e=>{const r=e.target.value;t(Object(E.b)(r)),d(r)};if(!e)return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(q,{authToken:c,onChange:b}),Object(l.jsx)(G,{})]});const j=new o.HttpLink({uri:"https://api.github.com/graphql",headers:{authorization:"Bearer ".concat(e)}}),u=o.ApolloLink.from([J,j]),p=new o.ApolloClient({link:u,cache:Y});return Object(l.jsxs)(o.ApolloProvider,{client:p,children:[Object(l.jsx)(q,{authToken:c,onChange:b}),Object(l.jsx)(U,{})]})}))}}]);
//# sourceMappingURL=r_graphql.f5444844.chunk.js.map